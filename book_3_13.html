<!DOCTYPE html> 
<html>
<head>
      <title>complex geomorphological classifications</title>
      <link rel="stylesheet" href="style.css">
</head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
* {
  box-sizing: border-box;
}


figure {
    width: 50%; /* Ширина если надо расположить 2 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 0%; /* Поля */
   }
   figure:first-child {
    margin-left: 0; /* Убираем отступ для первого элемента */
   }

picture {
 width: 33%; /* Ширина если надо расположить 3 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 0%; /* Поля */
}
picture:first-child {
    margin-left: 0; /* Убираем отступ для первого элемента */
   }

   image {
    width: 25%; /* Ширина если надо расположить 4 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 0%; /* Поля */
   }

</style>
</head>
<body>

		<div class="sidenav">
      
  <p><a href="#h1">III. ГЕОМОРФОМЕТРИЯ И СОВРЕМЕННЫЕ ПОДХОДЫ К ЛАНДШАФТНОМУ СИНТЕЗУ</a></p>
<p><a href="#h2">13. СЛОЖНЫЕ АЛГОРИТМЫ СЕГМЕНТАЦИИ РЕЛЬЕФА</a></p>

    <a href="#h3_1">13.1. Поколение новых моделей</a>
   	<a href="#h3_2">13.2. Классификации рельефа с использованием нечеткой принадлежности и нечеткого наложения</a>
	<a href="#h3_3">13.3. Методы сегментации рельефа, основанные на алгоритмах кластерного анализа</a>
	<a href="#h3_4">13.4. Методы "машинного" обучения и нейронные сети в классификации рельефа</a>


</div class="sidenav">

<div class="content">

<h1 id="h1">III. ГЕОМОРФОМЕТРИЯ И СОВРЕМЕННЫЕ ПОДХОДЫ К ЛАНДШАФТНОМУ СИНТЕЗУ</h1>

  <h2 id="h2">13. СЛОЖНЫЕ АЛГОРИТМЫ СЕГМЕНТАЦИИ РЕЛЬЕФА</h2>


<h3 id="h3_1">13.1. Поколение  новых моделей</h3>

<P>После того, как в геоморфометрии и ГИС-моделировании были разработаны метрики, позволяющие учитывать относительное местоположение на склоне, например, такие как <span class="monospace">Topographic Position Index|Индекс топографической позиции, Valley Depth|Глубина Долин, Height Above River|Высота над Уровнем Рек</span> и др., появился целый ряд  «прорывных» алгоритмов <a href="BIBLIO.html#EvansHenglGorsevski2009">[Evans, Hengl, Gorsevski, 2009]</a>, <a href="BIBLIO.html#Evans2012">[Evans, 2012]</a>, которые можно назвать моделями <bi>катенарно-гребне-килевой дифференциации</bi>.</p> 

<p>После добавления к этим моделями «третьего измерения» в виде семейства параметров кривизны <a href="BIBLIO.html#Shary_2006">[Шарый, 2006]</a>, <a href="BIBLIO.html#Florinsky_2016">[Флоринский, 2016]</a>, возникла возможность наглядно презентовать трехмерные свойства местоположений (геотопов по Н.А.Ласточкину <a href="BIBLIO.html#Lastochkin_1987">[Ласточкин, 1987]</a>) как в широком геоморфологическом (мезоформы рельефа - landform), так и в более специальном  (ландшафтные местоположения - landscape site) значении. </p>

<P>Широкое увлечение геоморфометрическими моделями <a href="BIBLIO.html#Hengl2009">[Geomorphometry..., 2009]</a> привело сначала (в первое десятилетие нового века) к неоправданному оптимизму и убеждению, что моделировать можно все что угодно, которые по прошествии времени и накоплении опыта сменились скепсисом. Однако, обнаруженные недостатки новых моделей с точки зрения теории оказались не менее интересными, чем безусловные достижения и полученные результаты.</p>

<P>Первый недостаток, или, вернее - затруднение, заключалось в раскрывшейся (в ходе моделирования) неопределенности, казалось бы, устоявшихся географических понятий, прежде всего - геоморфологических, таких как "гора", "равнина", или "крутой", "пологий" и т.д. В моделировании задействуются, как правило, предварительно классифицированные тематические растры: в самом простом примере с рельефом, это означает, что, вводя в модель параметры высоты и крутизны мы должны определиться с таксонами «низкий-высокий», и «пологий-крутой». Однако выяснилось, что используемые в традиционной географии классификаторы, зачастую,  локально некорректны и не универсальны в целом. Как мы уже убедились переменная <span class="monospace">абсолютная высота</span> земной поверхности, а, следовательно, и производные от нее показатели не подчиняются гауссову распределению;  включение в модель нескольких ненормально  распределенных параметров сильно осложняет последующую классификацию любых интегральных таксонов. Для преодоления этих сложностей были разработаны модели, учитывающие <span class="monospace">Fuzzy Membership|Нечеткую Принадлежность</span> (скажем, в виде правила «только 75% поверхностей с высотой более 500 м – «горы») и реализующие процедуры <span class="monospace">Fuzzy overlay|Нечеткого наложения</span>.</P>

<P>Второе затруднение связано с попытками избежать зависимости результатов от масштаба моделирования и «зернистостью» исходных данных, которая не позволяла передавать важнейшие свойства иерархичности и фрактальности природных структур, что достигается посредством внедрения мультимасштабных алгоритмов, реализующих процедуру изменения размера расчетного «окна» "на лету" параллельно изменению размерности субстрата <a href="BIBLIO.html#Jasiewicz_2013">[Jasiewicz, Stepinski, 2013]</a>.</P>

<p>Известный прогресс был достигнут на новом уровне, однако, (как это всегда бывает в науке) разрешение одних проблем вывело на повестку дня другие. В частности, нерешенными остались вопросы об объективной (т.е., независимой от мнения эксперта) размерности иерархических пространственных уровней дифференциации, и оптимальных алгоритмах нечеткого наложения.</p>

<p>Отмеченные выше затруднения отчасти обусловили спрос на "почти" автоматизированные методы (сводящие участие эксперта, казалось бы, к минимуму), среди которых наибольшее применение обрели алгоритмы кластерного анализа, представляющие собой способ автоматической классификации ("группирования", "сегментации", "стратификации", "таксономии")  сущностей в многомерном пространстве факторов и позволяющие разбивать совокупность объектов на группы по некоторому набору признаков (переменных). Методы кластеризации делятся на алгоритмы, предполагающие предварительное знание числа и характеристик итоговых классов - <span class="bolditalic">k-means кластеризация, дискриминантный анализ, деревья классификации</span> и алгоритмы, в которых свойства итоговых таксонов неизвестны, а их число известно лишь предположительно - <span class="bolditalic">изокластерный анализ, анализ группирования</span>.</p>

<p>Кластерный анализ применяется сегодня для решения широкого круга задач – от моделирования природных зон, до почвенного или ландшафтного картографирования, а также районирования и зонирования разного вида; можно сказать, что мы прибегаем к кластеризации, когда не очень хорошо представляем какие качества (признаки) объектов позволяют их классифицировать (или «группировать»), или когда таких признаков слишком много, либо они гетерогенны и сложно распределены.</p>

<p>Объективные преимущества такого подхода: возможность исследования сложных феноменов в многомерном пространстве ординации путем одновременной обработки практически любого числа переменных-факторов. Сложности – в сохраняющейся несмотря на "автоматизм") зависимости результата от решений эксперта, которые здесь распространяются, прежде всего, на число выходных классов, дистанцию соседства, размерность кластеров, локализацию затравок-образцов.</p>
<br>

<h3 id="h3_2">13.2. Классификации рельефа с использованием нечеткой принадлежности и нечеткого наложения</h3>

<p>Одна из проблем моделирования ландшафтной дифференциации заключается, с одной стороны - в необходимости предварительного классифицирования используемых тематик (растров факторных переменных), с другой  – в относительности (региональной пригодности) любых жестко закрепленных градаций: высотных градиентов («поясов»), уклонов и т.д. Принятие и использование алгоритмов нечеткой классификации для обнаружения элементов рельефа позволило использовать принципиально новые инструменты моделирования <a href="BIBLIO.html#Petry2005">[Petry, Robinson, Cobb, 2005]</a>.</p> 

<p>Теория нечетких множеств представляет собой альтернативный подход к классической теории множеств, который используется во многих областях науки в том числе в геоморфометрии и ландшафтной экологии. Существует два основных способа определения условий так называемой <span class="monospace">Fuzzy Membership|Нечеткой Принадлежности</span>. Первый способ опирается на экспертные знания и часто упоминается как <span class="bolditalic">модель семантического импорта (SI)</span>, второй способ называется <span class="bolditalic">модельным подходом отношения сходства» (SR)</span> и основывается на идентификации и характеристики кластеров данных. Нечеткие множества, генерируемые для различных переменных на основе ЦМР, а также нечеткие наложения переменных, часто обеспечивают удовлетворительные и выразительные модели местности <a href="BIBLIO.html#MacMillan2009">[MacMillan, 2009]</a>.</p>

<p>К полуавтоматическим классификациям, использующим алгоритмы нечеткой принадлежности (нечеткого множества - <span class="monospace">Fuzzy Membership</span>) могут быть отнесены:<br></p>

Curvature Classification,<br>
TPI Based Landform Classification, <br>
Fuzzy Landform Element Classification. <br>

<p>Мы продемонстрируем эти алгоритмы на примере горной территории Приэльбрусья с помощью программного пакета <span class="blue">SAGA GIS</span>, в котором они были впервые реализованы (в настоящее время можно пытаться запускать эти же скрипты в <span class="red">ArcMAP10.x</span> и <span class="gold">QGIS</span>, предварительно  добавив их к набору инструментов).</p>

<p><span class="blackbold">Curvature Classification</span>  (<span class="monospace">Terrain Analysis>>Morphometry</span>) - алгоритм классификации рельефа, основанный на сочетании различных видов параметров кривизны. Критическая опция диалога: выбор профильной (возможные варианты - <span class="monospace">Profile Curvature, Longitudinal Curvature</span>) и плановой кривизны (варианты - <span class="monospace">Tangential Curvature, Cross-Sectional Curvature</span>) <a href="BIBLIO.html#MacMillanShary2009">[MacMillan, Shary, 2009]</a>. Для Приэльбрусья применены опции:</p>

<div class="script">
Vertical Curvature:  Profile curvature,<br> 
Horisontal Curvature: Tangential Curvature,<br>  
Treshhold Raius|Пороговый радиус:  50000,<br>  
Smoothing/Генерализация:  5.</p>
</div>
<br>

<div class="script_01">
<figure>
<a id="curvature_classif"><img src="Pict_3_13/curvature_classif.png" width="350" height="relative"></a>
</figure>
<figure align=left>
<a id="curvature_classif_L"><img src="Pict_3_13/curvature_classif_L.png" width="35%" height="relative"></a> 
</figure>
</div>

<br>
<span class="imgtitle">Рис. 13.1 Результат классификации рельефа методом Curvature Classification: X - выпуклые, V - вогнутые; легенда: X|X - привершинные поверхности, GE|X - верхние части склонов, V|X - средние части склонов, X|GR - нижние части склонов, GR|GE - плоскость, V|GR - верховья и "третьи склоны" ложбин, X|V - средние звенья эрозионной сети, GE|V - днища долин, V|V - русловые элементы и замкнутые понижения 

<p>На выходе классификации <span class="blackbold">Curvature Classification</span> 8 мезоформ рельефа, индексированная посредством ссылки на форму склонов в плане и профиле <a href="#curvature_classif">(Рис. 13.1)</a>.</p>

<p><span class="monospace">Curvature Classification|Классификация по Кривизне поверхности</span> хорошо отражает пластику холмистого рельефа; однако в горах, где широко распространены прямые фрагменты и фасеты склонов алгоритм "отбивает" привершинные (и пригребневые) условно плоские поверхности, а также днища более-менее широких ущелий. Остальная территория дробится на фрагменты склонов, различающихся по положению (верхние, нижние) и крутизне. Комплементарная пригребневым (т.е., хребтам и контрфорсам) прикилевая эрозионная система с желобами вдоль склонов, распадками между склонами, и ущельями между хребтами, сохраняет целостность отображения лишь частично. Результат можно диверсифицировать и оптимизировать (до какой-то степени), выбирая иные виды кривизны (в позициях <span class="cursive">Vertical Curvatue</span> и <span class="cursive">Horizontal Curvature</span>) и меняя показатель <span class="cursive">Smoothing</span>, регулирующий уровень генерализации модели.</p>

<p>Следующий алгоритм классификации с использованием нечеткой принадлежности, реализованный в <span class="blue">SAGA GIS</span> - <span class="blackbold">Fuzzy Landform Element Classification</span> (<span class="monospace">Terrain Analysis>>Morphometry</span>) представляет собой делимитацию форм рельефа (landform) по уклону и нескольким другим параметрам, используемым в качестве входных данных для неконтролируемой классификации (например, <span class="monospace">ISODATA</span> или <span class="monospace">k-means</span>).</a></p>

<p>Моделирование включает два этапа. На первом рассчитываются три параметра, описывающие <span class="bolditalic">относительную неопределенность классификации</span>: <span class="monospace">Maximum Membership|Максимальная принадлежность</span>, <span class="monospace">Entropy|Энтропия</span>, и так называемый <span class="monospace">Confusion Index|Индекс конфузии» значений</span>. На втором этапе выделяются собственно местоположения.</p> 

<p>По умолчанию в позиции <span class="cursive">Imput</span> диалогового окна в качестве второй метрики выставлена абсолютная высота <span class="backgreen">Elevation</span>, однако алгоритм выдает более адекватный результат для варианта <span class="cursive">slope and curvatures</span>, позволяющего привлечь к анализу четыре вида кривизны: <span class="monospace">Minimum Curevature|Минимальная Кривизна, Maximum Curvature|Максимальная Кривизна, Proftle Curvature|Профильная кривизна, Tangetnial Curevature|Тангенциальная кривизна</span>.</p> 

<a id="fuzzylandformclass_tool"><img src="Pict_3_13/fuzzylandformclass_tool.png" width="450"></a>
<br><span class="imgtitle">Рис. 13.2 Диалоговое окно инструмента Fuzzy Landform Element Classification SAGA GIS

<p>Первичные метрики кривизны должны быть предварительно построены в <span class="blue">SAGA GIS</span> (инструмент <span class="blackbold">Slope, Aspect, Curvature</span>); также необходимо выявить пороговые значения крутизны склонов и кривизны через условное (в изображении) классифицирование  - это делается простым нажатием на слой в таблице данных <span class="monospace">Data>>RC>>Classify</span>.</p>

<p>Дефолтные пороговые значения  <span class="monospace">Slope|Уклона:</span> <span class="greencursiv">5<sup>0</sup></span> и <span class="greencursiv">15<sup>0</sup></span>. Это означает, что «плоская поверхность» имеет уклон менее <span class="greencursiv">5<sup>0</sup></span> (принадлежность <span class="greencursiv">slope=0</span>), а поверхность с крутизной более <span class="greencursiv">15<sup>0</sup></span> отнесена к «склону» (принадлежность  <span class="greencursiv">slope=1</span>); тогда как значения  в промежутке между этими пороговыми значениями (<span class="greencursiv">5<sup>0</sup> < slope < 15<sup>0</sup></span>) дают дробное значение принадлежности между <span class="greencursiv">0 и 1</span>. Например, если  уклон местности  <span class="greencursiv">7<sup>0</sup></span>, то вероятность отнесения ее к категории "плоскость"равна <span class="greencursiv">0,8</span> (или <span class="greencursiv">80%</span>), а вероятность отнесения к категории «склон»  соответственно <span class="greencursiv">0,2 (20%)</span>. В настройках <span class="blackbold">Fuzzy Landform Element Classification</span> по умолчанию в позиции <span class="cursive">Slope Treshhold (Degree)|Пороговое значение уклона (градусы)</span> выставлено <span class="greencursiv">2, 7</span> - параметры, подходящие скорее для холмистой местности, но не для высокогорья Северного Кавказа. В нашем случае применяем <span class="greencursiv">3, 18</span> соответственно.</p>

<div class="script_01">
<figure>
<a id="slopeevans4class"><img src="Pict_3_13/slopeevans4class.png" width="350" height="relative"></a>
</figure>
<figure align=left>
<a id="slopeevans4classL"><img src="Pict_3_13/slopeevans4classL.png" width="35%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.3 Классификация уклона для выявления граничных значений "плоскости" и "склона"

<p>Таким же образом, следует ориентироваться на значения <span class="monospace">Total Curvature</span>, чтобы корректно установить опцию <span class="cursive">Curvature Threshold</span>; по умолчанию здесь выставлены <span class="cursive">Пороговые значения кривизны</span>: <span class="greencursiv">0.000002; 0.00005</span> - которые следует воспринимать как "нулевые", т.е., указывающие на отсутствие кривизны, и доминирование рельефа, как бы набранного из плоскостей (фасеты и фрагменты склонов). Эти величины затем используются для вычисления вероятности того, что любое заданное значение попадает в диапазон значений вертикальной и горизонтальной кривизны для различных типов кривизны (например, минимальная, профильная и т. д.). Математика здесь достаточно проста; <span class="cursive">Пороговые значения кривизны</span>, установлены исходя из характерных для рельефа и  будут варьироваться в зависимости от типа характеризуемой местности: "переломные" значения  <span class="monospace">Total Curvature</span> выставляем ориентируясь на полученные предварительной классификацией этой переменной -  <span class="greencursiv">0.002</span> и <span class="greencursiv">0.005</span> соответственно.</p>

<div class="script_01">
<figure>
<a id="fuzzylandformclass_map"><img src="Pict_3_13/fuzzylandformclass_map.png" width="350" height="relative"></a>
</figure>
<figure align=left>
<a id="fuzzylandformclass_mapL"><img src="Pict_3_13/fuzzylandformclass_mapL.png" width="35%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.4 Классификация мезоформ Приэльбрусья на основе нечеткой принадлежности 

<p>Результатом применения алгоритма <span class="blackbold">Fuzzy Landform Element Classification</span></strong> являются 15 классов «формообразующих элементов» для понимания которых следует ориентироваться на матрицы комбинаций кривизны (см.  <a href="#book_3_11.html">раздел 11.1</a>,  <a href="#dicay_class">Рис. 11.3</a>).</p>


<br><span class="imgtitle">Таблица 13.1 Типология элементарных поверхностей Fuzzy Landform Element Classification</p>

<div class="table">
<table id="customers">
        <table border="1">
<tr>
<th>Привершинные/принизинные ЭП (макс-мин кривизны)</th>
<th>Пригребневые ЭП (горизонтальная-профильная кривизны)</th>
<th>Склоновые ЭП (горизонтальная-профильная кривизны) </th>
<th>Прикилевые ЭП (горизонтальная-профильная кривизны) </th>
</tr>
<tr>
<td>Peak|Пик выпукло-выпуклая привершинная ЭП "X/X"</td>
<td>Nose|Плечо выпукло-выпуклая ЭП "X/X"</td>
<td>Shoulder slope|Плечо склона выпуклая по профилю, прямая в плане склоновая ЭП "X/S"</td>
<td>Hollow shoulder|Выпуклая ложбина вогнутая в плане, выпуклая по профилю ЭП "X/V"</td>
</tr>
<tr>
<td>Plain|Плато (равнина) плоская привершинная ЭП "S/S"</td>
<td>Spur|Контрфорс прямо-выпуклая ЭП "S/X" </td>
<td>Planar slope|Простой склон, прямая в плане и в профиле склоновая ЭП "S/S"</td>
<td>Hollow|Вогнутая ложбина прямая по профилю вогнутая в плане ЭП "S/V"
</td>
</tr>
<tr>
<td>Saddle|Седло выпукло-вогнутая килевая привершинная ЭП "X/V"</td>
<td>Spur foot|Подножье гребня вогнуто-выпуклое "V/X"</td>
<td>Foot slope|Подножье склона вогнутое по профилю прямое в плане ЭП "V/S"</td>
<td>Hollow foot|Вогнутая по профилю концентрирующая вогнутая в плане ложбина ЭП "V/V"</td>
</tr>
<tr><td>Ridge|Пригребневая выпукло-плоская ЭП "X/S"</td>
<td>---</td>
<td>---</td>
<td>---</td>
</tr>
<tr>
<td>Channel|Трог плоско-вогнутая ЭП "S/V"</td>
<td>---</td>
<td>---</td>
<td>---</td>
</tr>
<tr>
<td>Pit|Замкнутая депрессия вогнуто-вогнутая ЭП "V/V"</td>
<td>---</td>
<td>---</td>
<td>---</td>
</tr>
</table>

* Примечание: S - прямые элементы, значение кривизн - <span class="greencursiv">0</span>, X - выпуклые элементы - значение кривизн <span class="greencursiv">+1</span>, S - вогнутые элементы, значения кривизн - <span class="greencursiv">-1</span>

<p>"Побочным" продуктом алгоритма <span class="blackbold">Fuzzy Landform Element Classification</span> являются три дополнительных растра, позволяющие лучше оценить результаты моделирования: <span class="monospace">Maximum Membership|Максимальная принадлежность</span></b>, <span class="monospace">Entropy|Энтропия</span>, <span class="monospace">Confusion Index|Индекс неопределенности</span>.</p>


<table id="customers">
      <table border="0" width="100%">
        <tr>
    <td><a id="FL_max_member_M"><img src="Pict_3_13/FL_max_member_M.png" width="300" height="relative"></a></td>
    <td><a id="FL_max_member_L"><img src="Pict_3_13/FL_max_member_L.png" width="60" height="relative"></a> </td>
    <td><a id="FL_entropy_M"><img src="Pict_3_13/FL_entropy_M.png" width="300" height="relative"></a></td>
    <td><a id="FL_max_member_L"><img src="Pict_3_13/FL_max_member_L.png" width="60" height="relative"></a> </td>
        </tr>
</table>

<br><span class="imgtitle">Рис. 13.5 Дополнительные растры - результат Fuzzy Landform Element Classification: a) Растр Maximum Membership|Максимальная принадлежность,  b) Entropy|Энтропия </p>

<p><span class="monospace">Максимальная принадлежность</span> характеризует надежность отнесения пикселя грида к тому или иному классу, можно убедиться, что она высока (около <span class="greencursiv">0,9</span>) для большей части сравнительно простых по форме склонов, и, напротив, низка (менее <span class="greencursiv">0,7</span>) для прикилевых форм и участков пойм и днищ ущелий. Соответственно противоположным образом распределена <span class="monospace">Энтропия</span>, максимальные значения которой (около <span class="greencursiv">0,2</span>) приходятся на днища долин и склоны сложных форм.</p>

<p>Еще один алгоритм, построенный на нечеткой логике и весьма популярный среди исследователей - <span class="blackbold">TPI Based Landform Classification|Классификация мезоформ на основе индекса Топографической позиции</span></b> -  широко используется при моделировании <span class="bolditalic">прогнозных|predictable</span> почвенных и ландшафтных карт.</p>

<p><span class="monospace">Topographic position index (TPI)|Индекс топографической позиции</span> – переменная второго порядка, позволяющая различать местоположения вдоль катены: от привершинных (пригребневых) ЭП до подножий склонов и прикилевых элементов эрозионной сети <a href="BIBLIO.html#Wilson_Gallant_2000">[Wilson, Gallant. 2000]</a>. <strong>A. Weiss</strong> <a href="BIBLIO.html#Weiss_2000">[Weiss, 2001]</a> предположил, что значения <span class="monospace">TPI</span>, полученные для разных размеров «скользящего окна» (т.е., в разных масштабах), могут использоваться для создания классификации местности или категоризации объектов и форм рельефа в пределах ландшафта. <strong>О. Конрад  (O. Conrad)</strong>  в рамках <span class="blue">SAGA GIS</span> разработал алгоритм, позволяющий сначала получить два разномасштабных индекса <span class="monospace">TPI</span>, а затем комбинировать их классифицированные растры.</p>

<p>Диапазоны значений <span class="monospace">TPI</span> могут использоваться для категоризации объектов и форм рельефа и классификации ландшафтных местоположений. Важно помнить, что <span class="monospace">TPI</span> зависит от масштаба; это означает, что размер и форма фокальной области, выбранной для расчета начальных значений, могут выделять или игнорировать те или иные элементарные поверхности.</p>

<p>До использования алгоритма имеет смысл получить несколько растров <span class="monospace">Topographic Position Index (TPI)</span> с разными соотношениями <span class="cursive">Кернель-радиуса</span> (позиция <span class="cursive">Scale</span>), и вариантами учета расстояний (<span class="cursive">Weighting Function</span>)</p>

<table id="customers">
   <table border="0">
       <tr>
    <td><a id="tpi_0_100_map"><img src="Pict_3_13/tpi_0_100_map.png" width="100%"></a></td>
    <td><a id="tpi_30_300_map"><img src="Pict_3_13/tpi_30_300_map.png" width="100%"></a></td>
    <td><a id="tpi_30_1000_map"><img src="Pict_3_13/tpi_30_1000_map.png" width="100%"></a></td>
    <td><a id="tangent_prof_curv"><img src="Pict_3_13/tpi_30_1000_map_L.png" width="30"></a> </td>
       </tr>
</table>

<br><span class="imgtitle">Рис. 13.7 Разномасштабные Индексы топографической позиции с соотношением "окон":  a) 0-100, b) 30-300, c) 30-1000</p>

<p>Значения <span class="monospace">TPI</span> изменяются от положительных (максимально  <span class="greencursiv">+2</span>), соответствующих привершинным и пригребневым местоположениям до отрицательных (<span class="greencursiv">-2</span>), отображающих килевые (поймы, ложбины. лощины) местоположения. Между этими значениями - верхние, средние и нижние участки склонов.</p> 

<p>На примере ключевого участка Приэльбрусья <a href="#tpi_0_100_map">(Рис. 13.7)</a> можно убедиться, что при небольших (по умолчанию <span class="greencursiv">0-100</span>) значениях окна алгоритм выявляет локальные вогнутые и выпуклые перегибы рельефа таким образом, что в пределах долин можно различать тыловые швы и днища (поймы), но остальные элементы гребне-килевой дифференциации разбиваются на множество отдельных фасет, что искажает реальную картину. Изменение порогового значения первого (меньшего) окна позволяет (<span class="greencursiv">30-300</span>) выделить более цельно систему пригребневых поверхностей. Для горных территорий может оказаться полезным учесть функцию расстояний как экспоненту (<span class="cursive">exponential</span>).</p>

<p>Алгоритм <span class="blackbold">TPI Based Landform Classification</span></strong> хорошо «различает» элементы гребне-килевой дифференциации, но итоговый растр предстает в «едином» масштабе без выявления иерархии форм, что отчасти объясняется использованием только двух масштабных окон анализа. Метод широко используется на локальном уровне, в частности для построения камеральных (гипотетических) почвенных карт, поскольку позволяет учесть различия в режимах (элювиальный, транзитный, аккумулятивный) почвообразования.</p>

<div class="script_01">
<figure>
<a id="tpibasedLFclass_map"><img src="Pict_3_13/tpibasedLFclass_map.png" width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="tpibasedLFclass_mapL"><img src="Pict_3_13/tpibasedLFclass_mapL.png" width="40%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.8 Классификация мезоформ территории Приэльбрусья на основе разномасштабных индексов топографической позиции

<p>На выходе модели -  10 условных форм рельефа:</p>
<ol>
<li><span class="bolditalic">High Ridges</span> - высокие хребты,</li>
<li><span class="bolditalic">Midleslope Ridges</span> - средневысотные хребты,</li>
<li><span class="bolditalic">Local Ridges</span> локальные боковые гребни (контрфорсы),</li>
<li><span class="bolditalic">Upper Slope</span> - верхние части склонов,</li>
<li><span class="bolditalic">Open Slope</span> - нижние части склонов, </li>
<li><span class="bolditalic">Plains</span> - равнинные участки,</li>
<li><span class="bolditalic">Valleys</span> - долины,</li>
<li><span class="bolditalic">Upland Drainages</span> - верхние элементы ложбинно-лощинной сети,</li>
<li><span class="bolditalic">Midleslope Drainages</span> средние участки долин,</li>
<li><span class="bolditalic">Streams</span> -  русла, конкретные параметры которых будут зависеть от используемой ЦМР и входных опций.</li>
</ol>
<br>


<h3 id="h3_3">13.3. Методы сегментации рельефа, основанные на алгоритмах кластерного анализа</h3>

<p>Учет смежных элементов мезорельефа – единственный способ выявления исчерпывающей характеристики местоположения. Мысль о необходимости учета общего характера поверхности для корректной дифференциации отдельных местоположений получила развитие в некоторых алгоритмах геоинформационного моделирования рельефа. Один из них – алгоритм <span class="blackbold">Terrain Surface Classification</span>, предложенный Дж. Ивахаши и Р. Пайком <a href="BIBLIO.html#IwahashiPike2007">[Iwahashi, Pike,2007]</a> и реализованный в <span class="blue">SAGA GIS</span>, предусматривает предварительный расчет так называемой текстуры (<span class="monospace">Texture</span>), выпуклости (<span class="monospace">Convexity</span>) и уклона <span class="monospace">Slope</span>.</p>

<p> <span class="blackbold">Terrain Surface Convexity</span> (<span class="monospace">Terrain Analysis>>Morphometry</span>) - сложная переменная, расчет которой предложен теми же авторами и реализован <strong>О. Конрадом (2015)</strong>. Перевод этого свойства как "выпуклость"  не исчерпывает вполне его содержания, можно лишь констатировать что <span class="monospace">Convexity</span> еще один способ отражения гребне-килевой и склоновой дифференциации поверхности. Использование инструмента предполагает сразу несколько критических настроек, заметно влияющих на итоговый растр. Прежде всего это <span class="monospace">Laplacian Filter Kernel</span>  - инварианты соседства ячеек расчетного окна:</p> 

<ul>
  <li>conventional four-neighborhood|четыре ячейки по сторонам,</li>
  <li>conventional eight-neighborhood| восемь ячеек, четыре по сторонам и четыре по угла</li>
  <li>eight-neighborhood distance based weighting|восемь со взвешенным расстоянием.</li>
</ul>
<br> 

<p>Вторая важная настройка <span class="monospace">Flat Area Threshold|Пороговое значение уклона плоской поверхности </span> с дефолтным значением <span class="greencursiv">0<sup>o</sup></span>, подходящим только для равнинных территорий, в горах его следует поднять по крайне мере до <span class="greencursiv">3<sup>o</sup></span>. Можно также поэкспериментировать с масштабом расчета <span class="monospace">Scale</span>, который выражается в числе ячеек (дефолтное значение <span class="greencursiv">10</span>). Критически важна опция <span class="monospace">Method</span>, предлагающая  выбрать между <span class="cursive">resempling|посев образцов</span> и <span class="cursive">counting cells|выбор по значению ячеек</span>. Может оказаться небесполезным экспериментирование с опцией <span class="monospace">Weighting function|Тип взвешивания расстояния</span>, в том случае если в позиции <span class="monospace">Laplacian Filter Kernel</span> было выставлено значение <span class="cursive">eight-neighborhood distance based weighting|восемь со взвешенным расстоянием</span>, наконец, чтобы конкретизировать этот вариант в последней позиции следует указать величину Brandwidth, если "взвешивание" расстояния производится по экспоненциальной функции (значение по умолчанию <span class="greencursiv">0,7</span>, может быть изменено в диапазоне от <span class="greencursiv">0,00</span> до <span class="greencursiv">1,00</span>).</p>

<div class="script_01">
<figure>
<a id="convexsity_map"><img src="Pict_3_13/convexsity_map.png" width="160%"></a>
</figure>
<figure align=center>
<a id="convexsity_mapL"><img src="Pict_3_13/convexsity_mapL.png" width="20%"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.9 Terrain Surface Convexity для территории Приэльбрусья

<p>Низкие значения (<span class="greencursiv">< 36</span>) <span class="monospace">Convexity</span> маркируют днища долин и ущелий, высокие (<span class="greencursiv">> 60</span>) - гребни хребтов и контрфорсы, между крайними значениями можно зафиксировать различные (верхние и нижние) части склонов. Растр <span class="monospace">Convexity</span> позволяет фиксировать и замкнутые понижение в высокогорье, которые могут быть ассоциированы с полуцирками, или верхними "тыловыми" частями склонов.</p>

<p>Инструмент <span class="blackbold">Terrain Surface Texture</span> имеет аналогичные опции настройки. Все три растровых файла <span class="backgreen">Convexity</span>, <span class="backgreen">Texture</span>, <span class="backgreen">SLope</span> заводятся вместе с основным файлом <span class="backgreen">Elevation</span> как входные для алгоритма <span class="blackbold">Terrain Surface Classification</span>.  Все опции настройки дублируют таковые для переменной <span class="monospace">Convexity</span>: <span class="monospace">Number of Classes|Число классов</span>, <span class="monospace">Scale|Масштаб</span>, <span class="monospace">Laplacian Filter Kernel</span> (определение модели соседства ячеек в расчетном окне), пороговое значение плоскости <span class="monospace">Flat Area Threshold</span>, - логично их воспроизвести и в этом скрипте.</p>

<p><span class="blackbold">Terrain Surface Classification</span> дифференцирует рельеф на число классов, кратное четырем - <span class="greencursiv">8</span>, <span class="greencursiv">12</span> или <span class="greencursiv">16</span>, и которые интерпретируются как <span class="bolditalic">склоны различной крутизны, фрагментированности и выпуклости/вогнутости</span>.</p>

<div class="script_01">
<figure>
<a id="texture_map"><img src="Pict_3_13/terrainsurfclass_map.png" width="350"></a>
</figure>
<figure align=center>
<a id="texture_mapL"><img src="Pict_3_13/terrainsurfclass_mapL.png" width="70%"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.10 Terrain Surface Classification - классификация форм земной поверхности</p>

<ol>
<li>very steep slope, fine texture, high convexity|верхние привершинные части круто-выпуклых рассеивающих склонов хребтов;</li>
<li>very steep slope, coarse texture, high convexity|круто-выпуклые протяженные средние части склонов;</li>
<li>very steep slope, fine texture, low convexity|верхние части прямых склонов хребтов;</li> 
<li>very steep slope, coarse texture, low convexity|нижние части слабо-выпуклых рассеивающих склонов; </li>
<li>steep slope, fine texture, high convexity|небольшие фрагменты покато-выпуклых склонов; </li>
<li>steep slope, coarse texture, high convexity|крупные покато-выпуклые склоны</li>
<li>steep slope, fine texture, low convexity|небольшие фрагменты привершинных крутых прямых склонов;</li>
<li>steep slope, coarse texture, low convexity|крупные участки крутых почти прямых склонов; </li>
<li>moderate slope, fine texture, high convexity| крупные  почти прямых нижних (приложбинных и придолинных) склонов; </li> 
<li>moderate slope, coarse  texture, high convexity|небольшие участки пригребневых седловидных поверхностей; </li>
<li>moderate slope, coarse  texture, high convexity|крупные участки полого-выпуклых склонов;</li>
<li>moderate slope, fine texture, low convexity|периферийные части замкнутых понижений;</li>
<li>gentle slope, coarse  texture, low convexity|склоны вторичных хребтов и контрфорсов;</li>
<li>gentle slope,fine texture, high convexity|верхние (тыловые) части ложбин и полуцирков<;/li>
<li>gentle slope, fine texture, low convexity|замкнутые понижения днищ долин и пойм, депрессии полуцирков;</li>
<li>gentle slope, coarse  texture, low convexity|слабо-наклонные плато и днища долин (ущелий), поймы рек.</li>
</ol>

<p>На территории Приэльбрусья алгоритм хорошо выделяет пригребневые поверхности, объединяя их систему основных хребтов с боковыми отрогами, а также контрфорсы и уступы; неплохо вычленяются и элементы эрозионной и долинно-речной сети. Однако, в предгорьях и на равнинах пластика форм, отображаемая этим алгоритмом не так наглядна, поскольку не вполне корректно «отбиваются» уступы субгоризонтальных поверхностей. Вполне вероятно, что опции для условных "гор" и "равнин" не могут быть выбраны корректно в пределах единой сцены, в этом случае естественным решением будет раздельное моделирование для горной системы и предгорной равнины.</p>

<a id="terrainsurfclass_map_zoom"><img src="Pict_3_13/terrainsurfclass_map_zoom.png" width="97%"></a>
<br><span class="imgtitle">Рис. 13.11 Terrain Surface Classification - детализированное 3D изображение</p>

<p>Другие недостатки проявляются при попытке интерпретации и детальном анализе результата. Во-первых, классификация "теряет" пространственную связь между элементарными поверхностями как по профилю (на катене), так и в плане. Последовательность номеров классов в этом отношении не должны вводить в заблуждение: таксоны сгруппированы по крутизне (очень крутые - крутые - покатые - пологие и плоские), дальнейшее различение осуществляется по крупности элемента (coarse-fine) и "выпуклости". Во-вторых, характеристики профильной кривизны  сведены только к мере "выпуклости", в итоге прямые и вогнутые склоны завуалированы как "слабовыпуклые", что затрудняет выделение килевых ЭП (например - элементов ложбинно-лощинной сети). В-третьих, классификация не содержит указаний на относительную высоту: одни и те же элементы (например <span class="greencursiv">11,12,14</span>) могут располагаться как на привершинной поверхности (на гребне или вершине горы), так и в пределах долин (поймы, террасы) или полузамкнутых понижений (цирков и полуцирков между вершинами).</p>
    
<p>Таким образом, алгоритм позволяет в общих чертах зафиксировать гребне-килевую дифференциацию (основные хребты и боковые гребни - таксоны <span class="greencursiv">1,3,5</span></span>), катенарную дифференциацию (<span class="greencursiv">5,6,4,8</span></span>), а также прикилевые ЭП (днища долин - <span class="greencursiv">16</span></span>, тыловые швы - <span class="greencursiv"></span></span>14, углубления низких пойм - <span class="greencursiv">15</span>), наконец -  замкнутые понижения различного генезиса на склонах (<span class="greencursiv">9,11</span>). Тем не менее, результат вполне можно рассматривать как "полуфабрикат" который может быть усовершенствован за счет добавления параметров относительной высоты (например, <span class="monospace">Height above river</span>) и формы склона (<span class="monospace">Plane Curvature</span>).</p>

<p><span class="blackbold">Terrain Clustering</span> - более сложный  и совершенный алгоритм, реализованный в  <span class="blue">SAGA GIS</span> <span class="monospace">(Tool Chains>>Terrain Analysis>>Terrain Clustering)</span>  предложен автором как "черный ящик"  <strong>(O. Conrad, 2015)</strong>, в котором пользователю предлагается выбрать только число классов и число итераций. Но если открыть скрипт в текстовом редакторе, то становится понятным, что перед нами - собой кластерный анализ с предварительным расчетом параметров <span class="monospace">Normalized Height|Нормализованной  высоты</span>, <span class="monospace">Aspect|Экспозиции</span>, <span class="monospace">Slope|Уклона</span>, <span class="monospace">Tangential curvature|Тангенциальной кривизны</span> и <span class="monospace">Total Gaussian curvature|Полной Гауссовой кривизны</span>,  <span class="monospace">Positive Openness|Положительной</span> и <span class="monospace">Negative Openness|Отрицательной топографической открытости</span>.</p>

<p>Показатели так называемой <span class="monospace">Открытости|Openness</span>"  привлекаются в данном алгоритме для контроля над размерностью и конфигурацией расчетного "окна", которые как бы следуют за размерностью реальных форм рельефа <a href="BIBLIO.html#Anders_et_al._2009">[Anders et al., 2009]</a>. <span class="monospace">Топографическая Открытость</span> связана с тем, насколько обширное пространство может быть увидено с конкретной позиции, поэтому положительные значения открытости выражают доминирование точки над местностью, а отрицательные - напротив замкнутость и закрытость. Было доказано, что <span class="monospace">Топографическая открытость</span> является возможным способом учета разномасштабных форм в геоморфологическом моделировании.  Инструмент <span class="blue">SAGA GIS</span> <span class="blackbold">Topographic Openness</span> (<span class="monospace">Terrain Analysis>>Lighting, Visibility</span>) позволяет моделировать одноименную переменную  с учетом фрактальности  (опция <span class="monospace">Method</span> - <span class="cursive">multi scale</span>) и в "одномерном" пространстве (<span class="cursive">line tracing</span>) <a href="BIBLIO.html#Yokoyama_2002">[Yokoyama et al., 2002]</a>.</p>

<div class="script_01">
<figure>
 <a id="positive_opennes_map"><img src="Pict_3_13/positive_opennes_map.png" width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="positive_opennes_L"><img src="Pict_3_13/positive_opennes_L.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.12 Показатель  Positive Openness - положительной топографической открытости для территории Приэльбрусья </p>

<p>Переменная <span class="monospace">Positive Openness</span> позволяет выделить участки, видимые практически с любой точки - гребни и пригребневые поверхности высоких хребтов; склоны гор имеют средние значения, причем заметно различие между выпуклыми (более видимыми) и вогнутыми фрагментами. Характерно также что зоны "невидимости" значительно шире реальных границ небольших ущелий и распадков. На дне крупных долин невидимыми являются в основном тыловые части пойм и примыкающие к ним подножья крутых склонов; центральные части относительно открыты.</p>

<div class="script_01">
<figure>
<a id="negative_opennes_map"><img src="Pict_3_13/negative_opennes_map.png"width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="negative_opennes_L"><img src="Pict_3_13/negative_opennes_L.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.13 Показатель Показатель  Negative Openness - отрицательной топографической открытости для территории Приэльбрусья</p>

<p>Переменная <span class="monospace">Negative Openness</span> не является простым "антиподом" положительной открытости и отличается более тонкой проработкой отрицательных форм рельефа, и, возможно, более адекватным представлением видимых привершинных областей.</p>

<p><span class="blackbold">Terrain Clustering</span> дифференцирует поверхность на кластеры, значения которых определяет пользователь, в этом еще одна особенность алгоритма.</p>

<div class="script_01">
<figure>
<a id="TerrainClustering_map"><img src="Pict_3_13/TerrainClustering_map.png" width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="TerrainClustering_mapL"><img src="Pict_3_13/TerrainClustering_mapL.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.14 Terrain Clustering - 16 классов мезоформ рельефа для территории Приэльбрусья</p>

<p>Также, как и в предыдущем случае, номера таксонов <span class="monospace">Terrain Clustering</span> условны, а их последовательность не отражает взаиморасположения в гребне-килевой и катенарной дифференциации, однако у эксперта всегда остается возможность переклассификации полученных таксонов и присвоения им необходимых индексов.</p>

<a id="Terrain Clustering_3D"><img src="Pict_3_13/Terrain Clustering_3D.png" width="97%" height="relative"></a>
<br><span class="imgtitle">Рис. 13.15  Классы мезоформ рельефа - фрагмент 3D изображение</p>

<p>Интерпретация результата на ключевом участке <a href="#errainClustering_map">(Рис. 13.14)</a> может выглядеть следующим образом:</p>
<ul>
<li>1 - днища долин и ущелий (в том числе поймы),</li>
<li>2 - выпуклые крутые верхние части пригребневых склонов,</li>
<li>3 - крутые фасы склонов и скальные стенки,</li>
<li>4 - плоские обширные, в том числе привершинные поверхности,</li>
<li>5 - короткие фасы прямых привершинных склонов,</li>
<li>6 - протяженные пологие нижние части склонов, рассеивающие,</li>
<li>7 - пологие и полого-наклонные плато,</li>
<li>8- локальные депрессии склонов,</li></ul>
<li>9 - желоба и кулуары, ложбины верхних частей склонов,</li>
<li>10 - гребни хребтов и контрфорсов,</li>
<li>11 - покатые и пологие слабовогнутые нижние части пригребневых склонов,</li>
<li>12 - самые верхние привершинные части рассеивающих склонов,</li>
<li>13 - бровки и уступы коренных склонов (и фрагментов террас) долин и ущелий,</li>
<li>14 - прямые и слабо-вогнутые средние части пригребневых склонов,</li>
<li>15 - протяженные лощины, распадки, желоба склонов.</li>
<li>16 - плоские вершины и платообразные поверхности на разных топографических уровнях,</li>
<br>

<p>Алгоритм кластеризации может быть воспроизведен пользователем самостоятельно с предварительным моделированием необходимых метрик и последующим запуском инструмента <span class="blackbold">K-Means Clustering for Grids</span> (<span class="monospace">Imagery>>Classification</span>): возможно это оптимальный путь, который позволяет варьировать состав метрик в зависимости от условий.</p>

<p><span class="blackbold">K-Means Clustering for Grids</span> - неконтролируемая классификация, основанная на  <span class="monospace">K-средних алгоритме</span>, определяющем центры кластеров и элементы, принадлежащие им, путем минимизации целевой функции, основанной на квадрате ошибок. Иными словами функция алгоритма заключается в том, чтобы расположить центры кластеров как можно дальше друг от друга и, одновременно, чтобы связать каждую точку данных с ближайшим центром кластера. <span class="monospace">Евклидово расстояние</span> обычно используется в качестве меры несходства в алгоритме k-средних - порог, который обозначает наименьшее возможное значение расстояние для перемещения центров кластеров перед остановкой итерационного процесса <a href="BIBLIO.html#Jain_2009">[Jain, 2009]</a>.</p>

<p>Набор переменных пользователь может выбирать по своему усмотрению исходя из характера местности, так для территории Армении апробировано сочетание <span class="monospace">Elevation, Flow Path Length|Длина Пути Потока, Plan Curvature, Profile Curvature, Slope </span><a href="BIBLIO.html#PiloyanKonečný2017">[Piloyan, Konečný, 2017]</a>.</p>

<p>Параметр <span class="monospace">Flow Path Length|Длина Пути Потока</span> рассчитывается в <span class="blue">SAGA GIS</span> (<span class="monospace">Terrain Analysis>>Hydrology</span>) и является еще одним показателем, используемым для конфигурирования матрицы водосборов а также для определения эрозионного потенциала территории. Этот инструмент вычисляет среднюю длину пути потока, начиная с "сеянных ячеек" (seeds) грида абсолютной высоты, которые  либо задаются случайной предварительно сгенерированной сеткой (опция <span class="monospace">Seeds</span> входных данных) либо извлекаются из вершин и гребней. Вторая критическая опция  -  <span class="monospace">Flow Routing Algorithm|Способ Маршрутизации Потока</span>, в этой позиции можно выбрать <span class="cursive">Detervinistic D8|Детерминированный 8 (D8)</span> <a href="BIBLIO.html#Callaghan1984">[O'Callaghan, Mark, 1984]</a>, предполагающий расчет по восьми обычным румбам, либо <span class="cursive">Multiple Flow Direction|Множественное направление потока (FD8)</span> <a href="BIBLIO.html#Quinn_et_al_1991">[Quinn et al., 1991]</a>. Последняя важная опция алгоритма - значение <span class="monospace">Convergence|Конвергенции</span> (дефолтное - <span class="greencursiv">1,1</span>).</p>

<div class="script_01">
<figure>
<a id="FlowPathLength_map"><img src="Pict_3_13/FlowPathLength_map.png"width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="FlowPathLength_L"><img src="Pict_3_13/FlowPathLength_L.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.16 Flow Path Length - метрика Длины Пути Потока </p>

<p>После определения набора входных растров  в диалоговом окне инструмента кластеризации <span class="blackbold">K-Means Clustering for Grids</span> необходимо выбрать число итоговых выходных кластеров (т.е., число классов) и один из трех возможных алгоритмов: <span class="cursive">Hill Climbing</span> <a href="BIBLIO.html#Rubin_1967">[Rubin, 1967]</a>,  <span class="cursive">Iterative Minimum Distance</span>  <a href="BIBLIO.html#Forgy_1965">[Forgy, 1965]</a>) или комбинированный способ <span class="cursive">Combined Minimum Distance/Hill Climbing</span>. Разумеется, результат будет сильно зависеть от набора переменных, размерность которых может быть весьма различной (скажем, длина пути потока может достигать многих сотен метров, максимальный уклон в градусах не превышает отвесного угла в 90<sup>o</sup>, а различные виды кривизны изменяются в долях единицы), поэтому в алгоритме присутствует опция нормализации данных <span class="monospace">Normalise</span>.</p>

<div class="script_01">
<figure>
<a id="kmens_relief_14_cluster_map"><img src="Pict_3_13/kmens_relief_14_cluster_map.png" width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="kmenas_relief_14_cluster_mapL"><img src="Pict_3_13/kmenas_relief_14_cluster_mapL.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.17 Неконтролируемая K-means кластеризации на 14 классов с пятью переменными

<p>Полезной особенностью метода является возможность получения таблицы статистики, дающей конкретное представление о характеристиках классов.</p>

<a id="kmenas_relief_14_cluster_table"><img src="Pict_3_13/kmenas_relief_14_cluster_table.png" width="60%"></a>
<br><span class="imgtitle">Рис. 13.18 Скриншот таблицы статистики 14 классов итогового растра неконтролируемой  кластеризации К-средних

<p>В свою очередь таблица статистики может быть использована для построения графиков с характеристиками кластеров</p>

<div class="script_01">
<figure>
<a id="kmenas_relief_14_plott_Hdem"><img src="Pict_3_13/kmenas_relief_14_plott_Hdem.png" width="100%" height="relative"></a>
</figure>
<figure align=center>
<a id="kmenas_relief_14_plott_Slope"><img src="Pict_3_13/kmenas_relief_14_plott_Slope.png" width="100%" height="relative"></a>    
</figure>
</div>

<div class="script_01">
<figure>
<a id="kmenas_relief_14_plott_PlanC"><img src="Pict_3_13/kmenas_relief_14_plott_PlanC.png" width="100%" height="relative"></a>
</figure>
<figure align=center>
<a id="kmenas_relief_14_plott_ProfC"><img src="Pict_3_13/kmenas_relief_14_plott_ProfC.png" width="100%" height="relative"></a>    
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.19 Графики свойств кластеров: а) абсолютная высота, b) уклон, c) плановая кривизна, d) профильная кривизна

<p>В заключение обзора возможностей кластерного анализа для сегментации рельефа изменив набора переменных и введя в позиции <span class="monospace">Grids</span> семь показателей: <span class="monospace">Normalized Height, Slope, Aspect, Tangential Curvature, Total Curvature, Positive Openness, Negative Openness</span>.</p>

<div class="script_01">
<figure>
<a id="KMeans_Clusters16_R_7_factor_map"><img src="Pict_3_13/KMeans_Clusters16_R_7_factor_map.png"  width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="KMeans_Clusters16_R_7_factor_Lp.png"><img src="Pict_3_13/KMeans_Clusters16_R_7_factor_Lp.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.20 Неконтролируемая K-means кластеризации на 16 классов с семью переменными (включая экспозицию)

<p>Как уже упоминалось выше результат кластеризации закономерно зависит от подбора факторов-переменных. Рисунки <a href="#KMeans_Clusters16_R_7_factor_map">13.20</a> и <a href="#KMeans_Clusters16_R_6_factor_map">13.21</a> демонстрируют эффект "выключения" всего одного фактора из набора - экспозиции. Очевидно, что в горах разнонаправленные склоны могут испытывать различный режим инсоляции, нагрева-охлаждения и увлажнения, поэтому этот фактор для горных территорий практически всегда значим.</p>

<div class="script_01">
<figure>
<a id="KMeans_Clusters16_R_6_factor_map"><img src="Pict_3_13/KMeans_Clusters16_R_6_factor_map.png"  width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="KMeans_Clusters16_R_6_factor_Lp.png"><img src="Pict_3_13/KMeans_Clusters16_R_6_factor_Lp.png" width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.21 Неконтролируемая K-means кластеризации на 16 классов с шестью переменными  (без экспозиции)

<p>Кластерным анализом является и алгоритм <span class="blackbold">Relief Segmentation</span> <span class="monospace">(Tools>>Tool Chains)</span>, представляющий собой "серый ящик" (инструмент построен в <span class="blackbold">Tool Chain</span> <span class="blue">SAGA GIS</span> - аналоге <span class="blackbold">Model Builder</span> <span class="red">ArcMAP10.x</span>), поскольку этапы расчета не раскрыты. Базовые метрики: <span class="monospace">Topographic Openness, Slope, Topographic Position Index, Topographic Wetness Index</span>. Последовательность расчетов выглядит следующим образом <a href="https://gis.stackexchange.com/questions/315415/relief-segmentation-tools-saga">(Relief Segmentation Tools, SAGA)</a>:

<ol>
<li>Рассчитываются метрики Topographic Openness, Slope, TPI и TWI;</li>
<li>Проводится анализ главных компонент (Principle Component Analysis);</li>
<li>По результатам анализа главных компонент осуществляется посев стартовых точек (Seed points);</li>
<li>На основании алгоритма "простого роста" строятся растровые ареалы;</li>
<li>Проводится векторизация ареалов в полигоны и расчет статистики по каждому полигону;</li>
<li>Проводится кластерный анализ на основании статистики;</li>
<li>Полигоны сливаются (dissolve) по номеру кластера.</li>
</ol>
 
<p>Таким образом, специфика данного алгоритма -  набор метрик (привлечение Индекса Топографической позиции Влажности) и использование процедуры <span class="blackbold">Анализ Главных Компонент</span>.</p>

<div class="script_01">
<figure>
<a id="reliefsegmentation_map"><img src="Pict_3_13/reliefsegmentation_map.png" width="350" height="relative"></a>
</figure>
<figure align=center>
<a id="reliefsegmentation_l"><img src="Pict_3_13/reliefsegmentation_l.png"  width="30%" height="relative"></a> 
</figure>
</div>
<br>
<span class="imgtitle">Рис. 13.22 Relief Segmentation - кластеризации на 16 классов для ключевого участка Приэльбрусья

<p>Алгоритм <span class="blackbold">Relief Segmentation</span> неплохо справляется с выделением привершинных местоположений, не разрывает и показывает днища и террасы крупных долин (отображены даже отдельные фрагменты пойм), сохранена целостность и иерархия вторичных боковых притоков, отдельно выделились расширенных верховья горных долин в виде расширенных языковидных форм, "перепиливающих" гребни хребтов.</p>

<a id="reliefsegmentation_zoom"><img src="Pict_3_13/reliefsegmentation_zoom.png" width="97%" height="relative"></a>
<br><span class="imgtitle">Рис. 13.23 Relief Segmentation - кластеризации на 16 классов (фрагмент)

<p>Неплохо передана и структура главных хребтов:  узкие гребни, примыкающие к ним крутосклонные скальные стенки, концентрирующие вогнутые в профиле и плане листовидные элементарные водосборы, и рассеивающие выпуклые участки склонов по обе стороны от контрфорсов.</p>

<p>Метод (при условии настройки) неплохо справляется с холмистыми территориями и среднегорьем. Поскольку в кластеризации участвуют сразу два индекса, характеризующие положение точки на склоне (<span class="monospace">TPI</span>) и относительно эрозионно-русловой сети (<span class="monospace">TWI</span>) критическую роль играет настройка соотношения двух масштабных окон (значение по умолчанию <span class="greencursiv">100, 1000</span>), небезразличны к результату и опции <span class="monospace">Number of Clusters|Число Кластеров</span> а также дистанция посева первоначальных точек <span class="monospace">Band Wind</span>.  В качестве примера  приведем более-менее удачно подобранных опций приведем пример классификации форм рельефа для территории природного парка Ергаки <a href="#reliefsegmentation_ergaki">(Рис. 13.24)</a> с хорошо отображенными двумя комплементарными и иерархически дифференцированными системами хребтов и долин.</p>

<a id="reliefsegmentation_ergaki"><img src="Pict_3_13/reliefsegmentation_ergaki.png" width="97%" height="relative"></a>
<br><span class="imgtitle">Рис. 13.24 Relief Segmentation - кластеризации на 12 классов для территории природного парка Ергаки
<br>


<h3 id="h3_4">13.4. Методы "машинного" обучения и нейронные сети в классификации рельефа</h3>


<p>Развитие методов "машинного" обучения и алгоритмов нейросетей не могло не коснуться и всегда актуальной и востребованной на практике проблемы сегментации рельефа земной поверхности. Инструмент <span class="blackbold">Geomorphones</span>  <span class="blue">SAGA GIS</span> <span class="monospace">(Terrain Analysis>>Lighting-Visibility)</span> пример практически практически полностью автоматизированного алгоритма с получением так называемых <span class="bolditalic">геоморфонов</span> - элементарных поверхностей или (в зависимости от масштаба) мезоформ рельефа  <a href="BIBLIO.html#Stepinski_2011">[Stepinski, Jasiewicz, 2011]</a>.</p> 

<p>Инструмент - типичный "черный ящик" (machine vision approach), на входе только файл высот <span class="backgreen">Elevation</span>   на выходе - растр <span class="backgreen">Geomorphons</span> - геоморфоны, регулируемые опции:
<span class="monospace">Threshold Angle|Пороговое значение уклона для плоскости </span> (по умолчанию <span class="greencursiv">1<sup>o</sup></span>); 
<span class="monospace">Radial Limit|Дистанция расчета</span> - дефолтное значение <span class="greencursiv">1000</span>, эту опцию можно менять в зависимости от размера и масштаба сцены методом "проб и ошибок"; <span class="monospace">Method</span> - критически важный параметр выбора одного из двух методов расчета <span class="cursive">Line Tracing|Линейный</span> или <span class="cursive">Multi Scale|Мультмасштабный</span>, в последнем случае предполагается возможность учета "фрактального числа.</p>

<p> В алгоритме  инструмента <span class="blackbold">Geomorphones</span>  заложена важная возможность изменения окрестностей расчета, связанных с размещением угловых точек неправильного многоугольника на характеристических точках рельефа, обладающих свойством <span class="cursive">положительной открытости</span>. Конфигурация неправильных восьмиугольников определяются по принципу прямой видимости в восьми основных румбов компаса (поочередно между каждой парой угловых точек <span class="greencursiv">a</span> и <span class="greencursiv">b</span> - они определяют фактический масштаб, в пределах которого делимитируется элементы рельефа <a href="BIBLIO.html#Jasiewicz_2013">[Jasiewicz, Stepinski, 2013]</a>.</p>

<div class="script_01">
<picture>
<a id="geomorphon_line_map"><img src="Pict_3_13/geomorphon_line_map.png" width="100%" height="relative"></a>
</picture>
<picture>
<a id="geomorphon_multyscale_map"><img src="Pict_3_13/geomorphon_multyscale_map.png" width="100%" height="relative"></a>
</picture>
<picture aline=right>
<a id="geomorphon_line_mapL"><img src="Pict_3_13/geomorphon_line_mapL.png" width="25%" height="relative"></a> 
</picture>    
</div>
<br>
<span class="imgtitle">Рис. 13.25 Геоморфоны: a) по алгоритму line tracing, b) по алгоритму multi scale</p>

<p>Несмотря на то, что шкала легенды <span class="monospace">Geomorphons</span> непрерывная, на самом деле перед нами атрибутированный растр с девятью значениями (где значения от <span class="greencursiv">1</span> до <span class="greencursiv">3</span> - привершинные поверхности, <span class="greencursiv">9</span> - днища пойм и долин, <span class="greencursiv">8</span> и <span class="greencursiv">7</span> - боковые эрозионные формы, остальные значения <span class="greencursiv">2,4,5,6</span> - склоны).</p>

<p>Можно видеть, что различия в алгоритмах сказываются на большей выраженности склонов в способе <span class="cursive">line tracing</span>, и в акцентировании привершинных и прикилевых поверхностей в способе <span class="cursive">multi scale</span>.</p>

<p>Таким образом, современные методы ГИС-моделирования предлагают достаточно широкий выбор алгоритмов различной сложности и разной степенью автоматизированности и участия эксперта. При этом на сегодняшний день лучший результат обеспечивают методы, основанные на кластерном анализе - <span class="blackbold">Terrain Surface Classification</span>, <span class="blackbold">Terrain Clustering</span>, <span class="blackbold">K-means кластеризации</span> с самостоятельным выбором факторов, <span class="blackbold">Relief Segmentation</span>.</p>


<a id="Fuzzy_tpi_har_my_model"><img src="Pict_3_13/Fuzzy_tpi_har_my_model.png" width="97%" height="relative"></a>
<br><span class="imgtitle">Рис. 13.26 Усовершенствованный алгоритм Fuzzy Overlay с добавлением переменной TPI третьей размерности и растром относительной высоты</p>

<p>Важно подчеркнуть, что современные средства моделирования, предоставленные пользователю в рамках практически всех популярных ГИС, позволяют экспериментировать с алгоритмами, добавляя или заменяя входные переменные, либо встраивая дополнительные процедуры. Так алгоритм <span class="blackbold">Fuzzy overlay</span>, основанный на сочетании разномасштабных индексов топографической позиции может быть оптимизирован добавлением третьего растра <span class="monospace">TPI</span> (третьей переменной топографического индекса), а также переменной, так или иначе отображающей относительную высоту местоположения <span class="monospace">Height above river</span>, <span class="monospace">Height above channels</span> <a href="#Fuzzy_tpi_har_my_model">(Рис. 13.26)</a>.</p>

<br>


</div>
<br>

<footer id="main-footer">Пространственный анализ в геоэкологии &copy; Е.Ю.Колбовский, 2022 </footer>
</div class="content">
</body>
</html>