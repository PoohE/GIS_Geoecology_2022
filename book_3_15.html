<!DOCTYPE html> 
<html>
<head>
      <title>biosynthesis</title>
      <link rel="stylesheet" href="style.css">
</head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
* {
  box-sizing: border-box;
}

figure {
    width: 50%; /* Ширина если надо расположить 2 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 0%; /* Поля */
   }
   figure:first-child {
    margin-left: 0; /* Убираем отступ для первого элемента */
   }

picture {
 width: 33%; /* Ширина если надо расположить 3 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 0%; /* Поля */
}
picture:first-child {
    margin-left: 0; /* Убираем отступ для первого элемента */
   }

   image {
    width: 100%; /* Ширина если надо расположить 1 картинки в ряд*/
    float: left; /* Выстраиваем элементы по горизонтали */
    margin: 0 0 0 0%; /* Отступ слева */
   text-indent: 0px; /* убираем отступ для картинки как ни странно */
   /* background: #f0f0f0; /* Цвет фона */
    border-radius: 1px; /* Радиус скругления */
    padding: 1%; /* Поля */
   }
</style>
</head>
<body>

	<div class="sidenav">
  <p><a href="#h1">III. ГЕОМОРФОМЕТРИЯ И СОВРЕМЕННЫЕ ПОДХОДЫ К ЛАНДШАФТНОМУ СИНТЕЗУ</a></p>

    <p><a href="#h2">15. ВОЗМОЖНОСТИ СИНТЕЗА БИОТЫ С МОРФОДИНАМИЧЕСКОЙ ОСНОВОЙ ЛАНДШАФТА</a></p>

		<a href="#h3_1">15.1. Объектно-ориентированная классификация изображений для выявления состояний ландшафта</a>
		<a href="#h3_2">15.2. Кластерная классификация состояний ландшафта</a>
		<a href="#h3_3">15.3. Подходы к синтезу ландшафтного покрова и морфологической основы ландшафта в гис-моделировании</a>
		<a href="#h3_4">15.4. Первый подход: оверлей готовых классификаций ландшафтных местоположений и биоты</a>
		<a href="#h3_5">15.5. Второй подход: синтез набора различных переменных, характеризующих признаки ландшафтных местоположений и состояний ландшафта</a>
		<a href="#h3_6">15.6. Сложные алгоритмы моделирования - классификация с возможностью обучения</a>
		
</div class="sidenav">

<div class="content">

<h1 id="h1">I. ГЕОМОРФОМЕТРИЯ И СОВРЕМЕННЫЕ ПОДХОДЫ К ЛАНДШАФТНОМУ СИНТЕЗУ</h1>

<h2 id="h2">15. ВОЗМОЖНОСТИ СИНТЕЗА БИОТЫ С МОРФОДИНАМИЧЕСКОЙ ОСНОВОЙ ЛАНДШАФТА</h2>


<h3 id="h3_1">15.1. Объектно-ориентированная классификация изображений для выявления состояний ландшафта</h3>

<p>Если цифровые модели рельефа используются для определения и делимитации мезоформ рельефа (и, следовательно - морфодинамической основы ландшафта), то космические снимки различных сенсоров (<span class="monospace">Landsat, Modis, Sentinel</span>) служат для выделения различных типов природных и/или культурных ландшафтов а также видов землепользования, что как раз и соответствует англоязычному словосочетанию  <span class="monospace">Landuse|Landcover</span>, зачастую заменяемому (особенно в работах, посвященных геоинформационному моделированию) более привычным <span class="monospace">Landcover</span>. Заметим, что попытки перевода этого термина на русский как "ландшафтный покров" или "ландшафтно-земельный покров" стилистически не вполне удобоваримы и поэтому вызывают острые возражения особенно у представителей школы классического российского ландшафтоведения. В этом смысле на современные гис-технологии лучше проецируются представления ленинградской школы ландшафтоведения, в рамках которых морфодинамическая основа ландшафтов определяется как "ландшафтные местоположения", а инварианты биоты и землепользования считаются "состояниями ландшафта" <a href="BIBLIO.html#IsaReznik_1996">[Исаченко, Резников, 1996</a>; <a href="BIBLIO.html#Isa1999">Исаченко, 1999]</a>. С этих позиций можно полагать, что, классифицируя космические снимки мы определяем типы (или виды) состояний ландшафтов.</p> 

<p>Для демонстрации методов классификации изображений с выделением состояний ландшафтов, а также для характеристики современных подходов к синтезу ландшафтных местоположений и ландшафтных состояний воспользуемся всей той же "сценой" - территорией Приэльбрусья (верховья реки Баксан), что позволит нам сравнить традиционные способы ландшафтного картографирования с современными алгоритмами полуавтоматизированного гис-моделирования.</p>

<p>Для определения числа классов ориентируемся на существующую ландшафтную карту национального парка "Приэльбрусье" (составленную А.Н.Гуней и М.Н.Петрушиной традиционным способом), в которой выделены 5 типов  и 13 подтипов ландшафтов 	<a href="BIBLIO.html#КолбГуняПетр_2022">[Колбовский, Гуня, Петрушина, 2022]</a> <a href="#landcarta">(Рис. 15.1)</a>.</p>

<div class="script_01">
<figure>
<a id="landcarta"><img src="Pict_3_15/landcarta.png" width="150%" height="relative"></a>
</figure>
<figure align=right>
<a id="landcartaL"><img src="Pict_3_15/landcartaL.png" width="40%" height="relative"></a> 
</figure>
</div>

<br><span class="imgtitle">Рис. 15.1 Ландшафтная карта (авторы А.Н.Гуня, М.Н.Петрушина)
<br>

<br>
<a id="landsat_8"><span class="imgtitle">Таблица 15.1 Типы и подтипы ландшафтов национального парка "Приэльбрусье"</span></a></p>

<div class="table">
	<table id="customers">
      <table border="1" width=100%>


<tr>
    
    <th rowspan="2">№</th>
    <th rowspan="2">Типы и подтипы ландшафтов</th>
    <th colspan="2">Критерии выделения при экспертном ручном картографировании</th>
    
 <tr>
    <th>Морфолитогенная основа</th>
    <th>Типы растительности и современное землепользование</th>
 </tr>
<tr>
  <th>1</th>
  <th>Нивально-гляциальные</th>
  <td>Выше 3500 (в отдельных случаях на склонах северной экспозиции — выше 3200)</td>
  <td>Снег, лед без следов использования</td>
</tr>
<tr>
  <td>1.1</td>
  <td>Ледниковые Снежно-ледниковые</td>
  <td>Более 4500 м</td>
  <td>Снег, лед без следов использования, господство отрицательных температур</td>
</tr>
<tr>
  <td>1.2</td>
  <td>Снежно-фирново-ледниковые</td>
  <td>На абсолютных высотах 3500 — 4500 м</td>
  <td>Снег, лед без следов использования, небольшой период с максимальными положительными температурами</td>
</tr>
<tr>
  <td>1.3</td>
  <td>Скально-снежные, с фрагментарным развитием накипных лишайников</td>
  <td>Выше 3500 м (в отдельных случаях на склонах северной экспозиции — выше 3200)</td>
  <td>Нет сплошного снега и льда, скально-снежные участки на летних снимках, все еще зона минимальных среднесуточных температур</td>
</tr>
<tr>
  <th>2</th>
  <th>Горно-луговые</th>
  <td>с 2000 м до границы нивально-гляциальных ландшафтов</td>
  <td>Задернованность и вегетация, отмечаемая на летних снимках</td>
</tr>
<tr>
  <td>2.1</td>
  <td>Субнивальные</td>
  <td>3000 (3100)  — 3500 м</td>
  <td>Проективное покрытие около 10-20%, как правило, не используемые</td>
</tr>
<tr>
  <td>2.2</td>
  <td>Лугово-тундровые</td>
  <td>2900 — 3100 м</td>
  <td>Проективное покрытие 20-50%, как правило, не используемые</td>
</tr>
<tr>
  <td>2.3</td>
  <td>Альпийские</td>
  <td>2700 — 2900 м</td>
  <td>Проективное покрытие 50-75%, как правило, редко используемые в качестве летних пастбищ</td>
</tr>
<tr>
  <td>2.4</td>
  <td>Субальпийские</td>
  <td>2400 — 2700 м</td>
  <td>Проективное покрытие более 75%, летние пастбища, реже — сенокосы</td>
</tr>
<tr>
  <td>2.5</td>
  <td>Остепненные</td>
  <td>Склоны южной экспозиции, 2000 (1900) — 2400 м</td>
  <td>Проективное покрытие более 75%, сезонные пастбища, реже — сенокосы</td>
</tr>
<tr>
	<th>3</th>
	<th>Горно-лесные</th>
	<td>До 2400 (2500) м, в основном, на склонах северной экспозиции</td>
	<td>Лесная растительность разной степени сомкнутости</td>
</tr>
<tr>
	<td>3.1</td>
	<td>Мелколиственно-криволесные</td>
	<td>Как правило, склоны северной экспозиции 2300 - 2500 м</td>
	<td>Березовые криволесья, куртинами, не используются</td>
</tr>
<tr>
	<td>3.2</td>
	<td>Мелколиственно-хвойные</td>
	<td>до 2300 м, склоны северной экспозиции, днище долины, реже –склоны южной экспозиции</td>
	<td>Сосновые леса с примесью березы, использование по днищам долин для рекреации</td>
</tr>
<tr>
	<td>3.3</td>
	<td>Мелколиственные</td>
	<td>Ущелья р. Малки и ее притоков</td>
	<td>Березовые мелколесья, не используются</td>
</tr>
<tr>
	<th>4</th>
	<th>Горно-степные</th>
	<td>Склоны южной экспозиции до 1900 м</td>
	<td>Степи с пятнами можжевельника, проективное покрытие около 40-60%, используются под круглогодичный выпас</td>
</tr>
<tr>
	<td>4.1</td>
	<td>Кустарниковые</td>
	<td>Склоны южной экспозиции до 1900 м</td>
	<td>Степи с пятнами можжевельника, проективное покрытие около 40-60%, используются под круглогодичный выпас</td>
</tr>
<tr>
	<th>5</th>
	<th>Горно-лугово-степные</th>
	<td>Днище долины ниже 1800 м</td>
	<td>Окультуренный ландшафт: селитьба, поливные сенокосы</td>
</tr>
</table>      	

<p>Таким образом, число классов в данном случае может быть принято равным 13-14.</p>

<p>Классификация изображений в геоэкологии - это процесс группировки пикселей изображения в классы, относящиеся к фрагментам природных и культурных ландшафтов и/или видам землепользования. Методы классификации могут также использоваться для мониторинга изменений окружающей среды, таких как формирование ареалов сплошных рубок или районов, пострадавших от пожаров. На практике получили распространение  две основные формы классификации: 1) классификация на основе пикселей и 2) классификация на основе объектов.</p>

<p><span class="bolditalic">Классификация на основе пикселей</span> рассматривает спектральный отклик или цифровые "подписи" для каждого пикселя и использует один из математических методов, назначающих их в класс. Существует две группы методов, с помощью которых классы пикселей могут быть назначены; <span class="bolditalic">unsupervised|неконтролируемые</span> и <span class="bolditalic">supervised|контролируемые</span> классификации.</p>

<p>В <span class="bolditalic">неконтролируемой классификации</span> классы могут быть присвоены автоматически на основе алгоритма группировки. Как правило, единственными определяемыми пользователем входными данными в этом процессе являются каналы|band космического снимка, которые используются в процессе назначения классов, а основной опцией - <span class="bolditalic">количество выходных классов</span> <span class="monospace"><span class="monospace">LandUse/LandCover</span></span>.  Наиболее распространенным, но далеко не единственным алгоритмом неконтролируемой классификацией является кластерный анализ и его различные инварианты.</p>

<p>В отличие от этого <span class="bolditalic">контролируемая классификация или классификация с обучением</span> требует от пользователя определения тренировочных (их еще называют "затравочными") участков известного типа LULC (ландшафтно-землепользовательского покрова). Пиксели затем группируются в <span class="bolditalic">классы</span> на основе спектральных данных пикселей тренировочного участка. Алгоритмы подобного рода считаются быстрыми и эффективными; однако они могут приводить к ошибкам, которые  трудно корректировать.</p>

<p>Существуют так называемые <span class="bolditalic">Object-based classification|Объектно-ориентированные  классификации</span>, которые вместо того, чтобы рассматривать отдельные пиксели группирует их в области ("сегменты") с аналогичными спектральными свойствами, и поэтому весь процесс именуется <span class="bolditalic">сегментацией</span>. Затем эти объекты могут быть классифицированы с использованием неконтролируемых или контролируемых методов. Объектно-ориентированная классификация предоставляет возможности более гибко редактировать классифицированные области и позволяет использовать более сложные методы, включающие форму сегмента и контекст.</p> 

<p>Алгоритм <span class="blackbold">Объектно-ориентированной классификации</span>, снимков серии <span class="monospace">Landsat</span> обычно включает пять последовательных действий:</p>

<div class="script">
Шаг 1: Отображение изображений Landsat посредством выбора композита - сочетания каналов,<br>
Шаг 2: Вырезание интересующей области,<br>
Шаг 3: Определение числа конечных классов,<br>
Шаг 4: Запуск сегментации изображения,<br>
Шаг 5: Оценка результатов,<br>
Шаг 5: Вычисление площадей.<br>
</div>

<p>Выбор комбинации каналов - один из самых важных шагов в этой последовательности, поскольку различные типы природных ландшафтов и виды землепользования, а также просто разные виды объектов по-разному отображаются в сочетаниях каналов. Подбор, как правило, осуществляется с опорой на уже имеющийся (и описанный в литературе) опыт, но адаптация и регионализация любого опыта под конкретную задачу, разумеется, предполагают готовность пользователя продвигаться итерационно -  многотрудным методом "проб и ошибок". Кроме того в сложных случаях не исключена вероятность, когда одни "сущности" (например, типы лесов) будут определяться по одному композиту, а другие (например, виды сельскохозяйственных угодий) - по-другому.  Для начала используем "популярный" композит <span class="monospace">Landsat 8</span> <span class="backgreen">NIR-Red-Green</span>  <span class="greencursiv">(5-4-3)</span> на территорию Приэльбрусья <a href="#543__zoom">(Рис. 15.2)</a>.</p>

<div class="script_01">
<figure>
<a id="543__zoom"><img src="Pict_3_15/543__zoom.png" width="100%" height="relative"></a>
</figure>
<figure align=right>
<a id="543_zoom"><img src="Pict_3_15/543_zoom.png" width="100%" height="relative"></a>  
</figure>
</div>
<br><span class="imgtitle">Рис. 15.2 Композит NIR-Red-Green (5-4-3) в искусственных цветах: а) горный район, b) предгорье и освоенная равнина

<p>Выберем для сегментации горную часть сцены, для которой мы располагаем ландшафтной картой. Для этого просто центрируем необходимую область в окне карты <span class="blue">SAGA GIS</span> используя инструменты <span class="cursive">Zoom</span> и <span class="cursive">Pan</span>. Быстрое вырезание в окне карты <span class="blue">SAGA GIS</span> производится инструментом <span class="blackbold">Clip Grid (Interactive)</span>  набора <span class="monospace">Grid</span> группы <span class="monospace">Grid System</span>. После запуска инструмента "стрелкой" <span class="cursive">Action </span>обводим прямоугольником видимую область; открывается диалоговое окно с параметрами выбранного фрагмента, если результат устраивает - <cursive>OK</span> (если нет, можно нажать на <span class="cursive">Escape</span> и попробовать еще раз.</p>

<p>Три вырезанных области трех каналов появятся в <span class="monospace">Новой Системе Грида</span> (поскольку размеры растра были изменены). Исходные слои можно отключить из просмотра, а вновь полученные - сохранить в проекте <span class="blue">SAGA GIS</span>.</p>

<p>Используем инструмент <span class="blackbold">Object Based Image Segmentation</span> набора <span class="monospace">Segmentation</span> группы <span class="monospace">Imagery</span>. Эта цепочка инструментов сегментации изображений на основе объектов объединяет ряд алгоритмов для удобного вывода геообъектов в виде полигонов и обычно применяется к спутниковым снимкам. Сегментация выполняется способом <span class="cursive">Seeded Region Growing Algorithm|Наращивание посевной области</span> <a href="BIBLIO.html#AdamsBischof">[Adams, Bischof, 1994</a>; <a href="BIBLIO.html#Bechtelf">Bechtelf et all,2008]</a>.</p>

<p>Инструмент <span class="blackbold">Object Based Image Segmentation</span> имеет сравнительно простой интерфейс; к выбираемым опциям относятся <span class="cursive">Band Width for Seed Points|Ширина полосы "посева" рандомных точек</span> - чем крупнее масштаб, тем, по-видимому, меньше должна быть величина, по идее большее значение должно привести к более крупным контурам. В позиции <span class="cursive">Post Procession (способ обработки)</span> выбираем <span class="cursive">Unsupervised Classification|Неконтролируемая Классификация</span>. В позиции <span class="cursive">Number of Classes|Число Классов</span> указываем <span class="greencursiv">14</span>. Флажок с опции <span class="cursive">split clusters</span> можно снять.</p>

<div class="script">
	
<span class="bolditalic">Object Based Image Segmentation</span><br>
Data Objects<br>
Grid Systems: ...<br>
 >>  Features: 3 objects (Landsat 8 NIR-5, Red-4, Green-3)<br>
Normalise: (оставляем пустым)<br>
Shapes<br>
<< Segments: create<br>
Options<br>
Band Width For Seeds Points Generations: 10<br>
Distance: features space and position <br>
Variance in Features Space: 1<br>
Variance in Position: 1 <br>	
Similarity Threshold: 0 <br> 
Generalisation: 1<br>
Post-Processing: unsupervised classification<br>
Number of Clusters: 14 <br>
Split Clusters: (оставляем пустым)<br>

</div>

<p>Появившийся векторный полигональный слой <span class="backgreen">Segments</span> добавляем к карте и раскрашиваем по 14 классам <span class="cursive">Graduated Color</span>.</p>

<a id="landcartaL"><img src="Pict_3_15/objUnsupervisClass543.png" width="100%" height="relative"></a>
<br><span class="imgtitle">Рис. 15.3 Результат дешифрирования (сегментации) композита NIR-Red-Green (5-4-3) на 14 классов</p>

<p>Сравнение слоя <span class="backgreen">Segment</span> с оригиналом ландшафтной карты позволяет увидеть плюсы и минусы автоматической неконтролируемой сегментации: неплохо различаются склоны с разной экспозицией главной долины, заснеженная вершина Эльбруса и высокие хребты, а также фрагменты склонов разной экспозиции, занятых альпийскими лугами и лесами разных типов.</p>

<p>Дальнейшая оптимизация работы с неконтролируемой сегментацией может заключаться в поиске оптимальных композитов, изменении числа классов и изменением параметра <span class="cursive">Ширина рандомного посева</span>. Алгоритм в любом случае остается прежним: вырезание необходимой области, составление композита из вырезанных фрагментов, сегментация. Так, например, композиты <span class="backgreen">TIR1-SWIR1-NIR</span>  <span class="greencursiv">10-6-5</span> или  <span class="backgreen">SWIR1-NIR-Red</span> <span class="greencursiv">6-5-4</span> дают иной результат <a href="#objUnsupervisClass10_65">(Рис. 15.4)</a>.</p>


<a id="objUnsupervisClass654"><img src="Pict_3_15/objUnsupervisClass654.png" width="65%" height="relative"></a>
<br><span class="imgtitle">Рис. 15.4 Результат дешифрирования (сегментации) композита SWIR1-NIR-Red (6-5-4) на 14 классов</p>
<br>


<h3 id="h3_2">15.2. Кластерная классификация состояний ландшафта</h3>

<p>Кластерный анализ - один из способов классифицирования, который  разбивает совокупность объектов на классы (кластеры, группы), и, в некоторых случаях позволяет попутно выявить оптимальное число групп. Считается, что мы прибегаем к кластеризации, когда не очень хорошо представляем какие качества (признаки) объектов позволяют их классифицировать. </p>

<p><span class="blackbold">K-Means Clustering|К-Среднее кластеризация</span> - это еще один вариант неконтролируемой классификации, который автоматически разделяет пиксели изображения на определенное число категорий, имеющих сходные спектральные характеристики. Начальные  "сеянные" пиксели служат для инициирования неконтролируемого алгоритма K-средних.  Группы пикселей имеют одинаковые значения, а стандартные отклонения и дисперсии невелики.   Успешность и эффективность кластеризации относительна, так как число классов, назначенных пользователем, может включать в себя несколько типов ландшафтов (или видов землепользования), которые на самом деле имеют сходные спектральные характеристики, что может быть проблемой для анализа и приведет к ошибкам в характеристиках выходных классов. </p>

<p>В <span class="blue">SAGA GIS</span> к инструментам неконтролируемой классификации относится алгоритм <span class="blackbold">K-Means Clustering for Grids</span> набора <span class="monospace">Classification</span> группы <span class="monospace">Imagery</span>. Одно из преимуществ данного алгоритма - неограниченное число включаемых в анализ компонентов - в данном случае каналов Landsat, а также возможность получить статистики, объясняющие характеристики каждого кластера (класса).</p> 

<div class="script">

<span class="bolditalic">K-Means Clustering for Grids</span> <br>
Grids<br>
Grid System: ...<br>
 >>  Grids: 4 Objects (Landsat 8, * отображаются выбранные каналы, SWIR2-7, NIR-5, Red-3, Green-4)<br>
<< Claster: create <br>
Tables<br>
<< Statistics: create<br>
Options<br>
Method: Hill_Climbing Rubin<br>
Clusters: 14<br>
Maximum iterations: 10<br>
Normalise: оставить пустым<br>
Start position: random<br>
</div>

<P>В диалоговом окне инструмента кроме опции выбора числа классов критическим являются <span class="monospace">Method|Cпособ кластеризации</span>; предлагаются два различных: <span class="cursive">Iterative minimum distance </span> <a href="BIBLIO.html#Forgy_1965">[Forgy, 1965]</a>, <span class="cursive">Hill climbing </span> <a href="BIBLIO.html#Rubin_1967">[Rubin, 1967]</a>, и <span class="monospace">Combined</span>, который является компромиссом между обозначенными двумя.</p>

<div class="script_01">
<figure>
<a id="kmeans_iterrat_zoom"><img src="Pict_3_15/kmeans_iterrat_zoom.png"  width="100%"> </a>
</figure>
<figure align=right>
<a id="LandMAP_zoom"><img src="Pict_3_15/LandMAP_zoom.png" width="100%"></a>
</figure>
</div>
<br><span class="imgtitle">Рис. 15.5 Сравнение результата кластеризации на основе каналов SWIR2-NIR-Red-Green (7-5-3-4) на 14 классов по алгоритму Iterative minimum distance с исходной ландшафтной картой на Приэльбрусье
<br>
<div class="script_01">
<figure>
<a id="kmeans_hill_zoom"><img src="Pict_3_15/kmeans_hill_zoom.png" width="100%"></a>
</figure>
<figure align=right>
<a id="LandMAP_zoom"><img src="Pict_3_15/LandMAP_zoom.png" width="100%"></a>
</figure>
</div>
<br><span class="imgtitle">Рис. 15.6 Сравнение результата кластеризации на основе каналов SWIR2-NIR-Red-Green (7-5-3-4) на 14 классов по алгоритму Hill climbing с исходной ландшафтной картой на Приэльбрусье

<p>Совершенно очевидно, что <span class="blackbold">K-Means Clustering for Grids</span> - более "умный" алгоритм, поскольку полученный результат гораздо ближе в привычному "рукотворному" варианту ландшафтной карты: мы видим отчетливо прорисованный конус Эльбруса со снежно-фирновым поясом, высокие скально-снежные хребты с боковыми субнивальными отрогами, альпийские луга, фрагменты хвойных и мелколиственных склонов а также сохраненную систему долинных ландшафтов (в неконтролируемой сегментации она в значительной степени была разорвана на отдельные "патчи"), хорошо проработаны и боковые притоки с обращенными к ним контрфорсами  вторичных хребтов и отдельных склонов различной экспозиции; отображена и общая "фрактальность" ландшафтной мозаики.</p>

<a id="cluster7543_hill_table"><img src="Pict_3_15/cluster7543_hill_table.png" width="350" height="relative"></a>
<br><span class="imgtitle">Рис. 15.7 Скриншот таблицы значений кластеров для классификации по алгоритму  Hill climbing 

<p>Дополнительно генерируемая алгоритмом <span class="blackbold">K-Means Clustering for Grids</span> таблица значений кластеров (отражающая характеристики для каждого класса по выбранным каналам <span class="monospace">Landsat 8</span>, среднее квадратическое отклонение и число пикселей данного класса) может быть сохранена в форматах <span class="monospace">CSV</span> или <span class="monospace">DBF</span>, затем проанализирована в <span class="monospace">Excel</span>.</p>

<p>О разбросе значений отдельных кластеров можно судить, построив в <span class="blue">SAGA GIS</span> с помощью инструмента <span class="blackbold">Scatterplot</span> диаграмму рассеяния, где по оси <span class="greencursiv">Y</span> - значения стандартного отклонения <span class="cursive">(StdDev)</span>, а по оси <span class="greencursiv">X</span> - номера кластеров <span class="cursive">(Cluster)</span>.</p>

<a id="clusterKmeans14_hillclmbPlot"><img src="Pict_3_15/clusterKmeans14_hillclmbPlot.png" width="65%"  height="relative"></a>
<br><span class="imgtitle">Рис. 15.8 График разброса кластеров для классификации по алгоритму  Hill climbing </p>
<br>


<h3 id="h3_3">15.3. Подходы к синтезу состояний и морфодинамической основы ландшафта в гис-моделировании</h3>

<P>По причинам объективного характера геоинформационное моделирование развивалось прежде всего в рамках европейской и североамериканской версий ландшафтной экологии, однако самое интересное заключается в том обстоятельстве, что практически все алгоритмы ГИС-моделирования  воспроизводили "на новый лад" известные и до сих пор дискуссионные "сюжеты" российского ландшафтоведения, в более широком контексте — географии в целом. <span class="bolditalic"> Последовательно разрабатываемые и сменявшие друг друга подходы к ГИС-моделированию сложных объектов и феноменов во многом отражают логику научного поиска и эволюцию представлений в рамках классической науки о ландшафтах</span>. В этом смысле можно выделить следующие этапы развития ГИС-моделирования геосистем:
</p>
<ul>
1)	экспертно-интуитивное выделение границ способом ручного рисования — первоначально в программе векторной графики, позже в различных ГИС-пакетах;<br>
2)	гибридное экспертно-компьютерное картографирование на основе комбинированного оверлея в среде ГИС предварительно оцифрованных традиционных тематических карт (геологических, геоморфологических, геоботанических, почвенных и т.д.);<br>
3)	комбинированный оверлей классифицированных растровых переменных (производных от ЦМР и снимков типа Landsat), изначально полученных в ГИС и отображающих различные параметры морфолитогенной основы и растительного покрова/землепользования;<br>
4)	учет катенарной (склоновой) и гребне-килевой дифференциации с использованием соответствующих геоморфометрических переменных (например — индекса относительного положения на склоне);<br>
5)	модели нечеткого наложения с использованием переменных с нечеткой принадлежностью;<br>
6)	полуавтоматизированные модели кластеризации и группирования, основанные на k-средних, искусственных нейронных сетях и деревьях классификации, применяемых к более или менее широкому набору переменных;<br>
7)	иерархические (поэтапно выполняемые) модели с участием эксперта, задающего правила в рамках классической или нечеткой логики и смены "ведущего фактора дифференциации".<br>
</ul>
</p>
<p>Важно подчеркнуть — перечисленные подходы не абсолютно инновационные, поскольку их логические и математические основания были разработаны в середине либо второй половине XX в., но опыт применения строгих и воспроизводимых ГИС-алгоритмов, позволил выявить их возможности и ограничения, преимущества и недостатки.</p>

<p><span class="bolditalic">Экспертно-интуитивный подход (в западной науке часто именуется как "гештальт-метод")</span> <a href="BIBLIO.html#Wilson_2018">[Wilson, 2018]</a> заключается в экспертном выделении и ручном рисовании границ геосистем. В своем "классическом" виде он был отработан первоначально в отечественном почвоведении <a href="BIBLIO.html#Временная_1984">[Временная методика, 1984</a>; <a href="BIBLIO.html#Степанов_2006">Степанов, 2006]</a> и доведен до совершенства в рамках методики российского ландшафтного картографирования <a href="BIBLIO.html#Видина">[Видина, 1962</a>; <a href="BIBLIO.html#Isachenko_1973">Исаченко, 1999</a>]. Сущность метода заключается в том, что эксперт выделяет границы ландшафтов (или их частей) сначала в камеральных условиях ориентируясь на несколько источников-подложек (карта четвертичных отложений, разгруженная топографическая карта с горизонталями, фотоплан), действуя, частично, в рамках задаваемых правил формальной логики ("если — то"), частично — руководствуясь интуицией (опытом). Сегодня классический метод не утратил своего значения (прежде всего — дидактического, обучающего), и воспроизводится в ГИС, являя собой вариант рисования в векторных слоях; возможно, один из наиболее замечательных примеров подобных рода "state of art mapping" — ландшафтные карты Атласа ООПТ Санкт-Петербурга <a href="BIBLIO.html#Атлас_2013">[Атлас..., 2016]</a> .

<p>Важно подчеркнуть, что в классическом варианте ручного картографирования исследователь зачастую трассирует отрезки границ между геосистемами одного и того же уровня по разным "тематикам" (переменным), т.е., <span class="bolditalic">осуществляет смену ведущего фактора дифференциации в соответствии с экспертной концепцией "на лету"</span>. В одном случае граница между урочищами может пролегать по рубежу между четвертичными отложениям, в другом  —  по морфоизографе, отделяющей ложбину от водораздела, в третьем по границе между луговой и лесной растительностью <a href="BIBLIO.html#Жучкова">[Жучкова, Раковская, 2004]</a>. 

<p><span class="bolditalic">Гибридное экспертно-геоинформационное картографирование опирается на векторизацию бумажных карт, с последующим наложением и согласованием полученных тематических слоев.</span> Таким образом, например, была построена государственная  <a href="BIBLIO.html#Ландшафтная карта_1980">[Ландшафтная карта Мингео СССР] </a> масштаба 1:2500000. Основным методом синтеза в рамках этого подхода было наложение — процедура, которая с позиций формальной логики и математики аналогична оверлею в современных ГИС: комбинированию растров или пересечению полигональных векторов. <b>К. Лоуэлл</b> <a href="BIBLIO.html#Lowell_1990">[Lowell, 1990]</a> и <b>Р. Бейли</b> <a href="BIBLIO.html#Bailey_1998">[Bailey, 1998]</a> отмечали, что, хотя наложение карт представляется самым логичным методом идентификации экосистем, этот подход имеет недостатки, к которым можно отнести:</p>

<ol>
	<li>Произвольность и невоспроизводимость классификаторов, неизбежно возникавшая в результате смешения традиционных тематических карт (геологических, геоботанических, почвенных), изначально разработанных под разные задачи; </li>
	<li>Эффект информационного шума, проявляющийся в избыточном количестве классов, многие из которых статистически ничтожны;</li>
	<li>Эффект мозаичной "пилы" вдоль границ классов; </li>
	<li>Невысокая, как правило, точность (в том числе вследствие различной детальности и масштабов исходных материалов).</li>
	</ol>

<p>По этим же причинам не слишком удачными оказались и попытки сочетания оцифрованных тематических карт, так или иначе являющимися результатом традиционного мануального картографирования с переменными-производными от ДДЗ <a href="BIBLIO.html#SayreR_2008">[Sayre R., 2008]</a>.</p>

<P>Настоящее геоинформационное моделирование связано с появлением работ, в которых наложению подвергались не оцифрованные, а новые тематические (факторные) слои (растровые и векторные) изначально полученные в ГИС  посредством преобразования <span class="monospace">Цифровой Модели Рельефа</span>, или дешифрирования космических снимков, расчета различных коэффициентов по разным сочетаниям каналов и т.д. Так, сочетанием классифицированных растров абсолютной и относительной высоты, уклона и обобщенной кривизны можно получать неплохие и выразительные модели для мелкомасштабного картографирования (см например, карту морфоструктур Африки, полученную таким образом)  <a href="https://rmgsc.cr.usgs.gov/outgoing/ecosystems/AfricaData/">Global Ecosystems</a>. Однако, (против первоначальных ожиданий) оказалось, что и в этом случае комбинирование растров и пересечение векторов, хотя и может дать корректный результат в случае наложения относительно несложных и немногих переменных, тем не менее, не может служить удовлетворительным способом многофакторного экосистемного (ландшафтного) синтеза. 

<p>Максимальное число слоев, которые могут быть подвергнуты оверлею простым комбинированием не может превышать трех, в крайнем случае - четырех "тематик", потому что уже при парном комбинировании  (например. простейшем комбинировании абсолютной высоты и уклона) образуются избыточное число сложно интерпретируемых финальных классов, некоторые из которых к тому же являются <span class="bolditalic">пустыми множествами</span>, т.е., представляют собой совокупности  мыслимых логически, но ничтожных по количеству объектов. Этот эффект заметно усиливается при добавлении в комбинацию растров (или пересечение тематических векторных слоев) каждого нового слоя, что делает данный способ в целом малопригодным для делимитации любых феноменов существующих в многомерном пространстве факторов: ландшафтов, геосистем, экосистем.</p>

<p>Другая очевидная слабость простого комбинирования (растров) или пересечения (векторных слоев) заключается в исходном признании равенства значения факторов. Между тем в реальной действительности в одном случае более сильным фактором формирования и функционирования экосистем может выступать высота места, в другом - экспозиция склона, в третьем - крутизна и т.д. Простой оверлей комбинированием растров позволяет учесть иерархию факторов в виде итоговой классификации за счет процедуры конкатенации позволяющей вывести на первое место в итоговом индексе  наиболее значимый показатель. Например, классификация иерархических уровней ландшафтных местоположений может выглядеть как "высота-экспозиция-уклон", или как "экспозиция-высота-уклон", но на комбинаторную мозаику и границы классов результирующего растра изменение позиции в индексировании не повлияет.</p>

<p><span class="bolditalic">В классическом ландшафтоведении при ручном картографировании это затруднение преодолевалось через представления о ведущем  факторе, что определяло не только иерархию итоговой классификации, но и технику мануально-экспертного рисования</span>, конкретно - на конфигурацию каждого  оверлея, который подвергался последовательной корректировке и отбраковке несущественных деталей <a href="BIBLIO.html#Видина">[Видина, 1962;</a> <a href="BIBLIO.html#Жучкова">Жучкова,  Раковская, 2004]</a>.</p>

<p>В ГИС-моделировании строгим алгоритмом учета силы/значимости признаков в многомерном пространстве ординации является <span class="bolditalic">Weighted Overlay|Взвешенное Наложение</span> - процедура, в рамках которой пользователь назначает "вес" слою в виде целых или десятичных коэффициентов. Например, если мы полагаем, что в условиях выраженной высотной поясности высота места в два с половиной раза более значима чем уклон, а экспозиция - в два раза более важна чем уклон, то факторам при оверлее должны быть присвоены значения <span class="greencursiv">1</span> - <span class="monospace"slope>slope</span>, <span class="greencursiv">2</span> - <span class="monospace"slope>aspect</span>, <span class="greencursiv">2,5</span> - <span class="monospace">height</span>.</p> 

<p>Будучи более совершенным по сравнению с простым комбинированием <span class="blackbold">Взвешенное Наложение</span></span> имеет свои ограничения. Во-первых, трудно представить себе ситуацию, когда соотношение значимости факторов остается постоянным в пределах всей сцены моделирования: например, в предгорье, среднегорье и высокогорье. Следовательно, сцены должна быть разделена на фрагменты, каждый из которых обрабатывается отдельно.</p>

<p>Другое, более существенное затруднение заключается в невозможности учитывать через <span class="blackbold">Взвешенный оверлей</span> обстоятельство <span class="bolditalic">синергетического действия факторов (признаков)</span>. Например влияние экспозиции обычно связано с уклоном и может быть значимым начиная с некоторых значений последнего: скажем, степень прогрева южных склонов может экспоненциально возрастать на склонах крутизной свыше <span class="greencursiv">5-8<sup>0</sup></span>, но при этом может не проявляться на высоте менее <span class="greencursiv">500 м</span> вследствие затенения параллельным хребтами, и далее - на высоте свыше <span class="greencursiv">2200 м</span> - фактор экспозиции может почти нивелироваться факторами крутизны и гребне-килевой дифференциации, поскольку именно два последних контролируют, например, сохранность снежников.</p>

<p>Взаимосвязи подобного характера требуют уже более сложных алгоритмов моделирования, в том числе разработанных с использованием аппарата нечеткой логики. Выше на примере геоморфометрических переменных и моделирования форм мезорельефа мы обращались к полуавтоматизированным алгоритмам нечеткой принадлежности и нечеткого наложения <a href="book_3_13.html%20#h3_4">(см. раздел 13.4.)</a>. Однако для решения более сложных задач эти инструменты используются иначе - с разработкой предварительной гипотезы и свода правил, выраженных на языке <span class="bolditalic">Fuzzy Logic|Нечеткой Логики</span>.</p>

<p><span class="bolditalic">Исходная предпосылка нечеткой логики заключается в признании двух видов неопределенности в данных, подающихся на "вход" модели: неопределенность в атрибутах и неопределенность в локализации (пространственном расположении)</span>. Таким образом первая неопределенность отображает невозможность однозначного ответа на вопрос "что", вторая - на вопрос "где". Неопределенность в атрибутах существенно значима для моделей обсуждаемого типа, поскольку позволяет описывать размытость (неточность) границ между классами и работать с ситуациями, в которых строгие границы между классами принципиально невозможны, т.е., речь идет как раз об упомянутом выше методологическом "камне преткновения", выраженном в названии статьи <i>"Do mountain exist?"</i>.</p>

<p>Нечеткая логика определяет возможности (или вероятности) того, что тот или иной объект, характеризующийся неким набором признаков, относится к определенному классу ("гора", "холм", "разнотравно-злаковый луг", "сосняк бруснично-зеленомошный"). Подчеркнем, что речь идет не просто о неточности измерений (что тоже имеет место), но и о естественном протяженном характере переходов (экотонов) между "ядрами" типичности классов - явление, давно уже описанное в классическом ландшафтоведении, и приводящее многих исследователей к мысли о невозможности "векторного" моделирования ландшафтов.</p>

<p>Использование алгоритмов нечеткой логики предполагает предварительное построение гипотезы с ансамблем правил, описанных на языке нечеткой (не булевой) логики. Допустим пользователь полагает уклон важным фактором ландшафтной дифференциации. В обычном случае мы используем один из вариантов экспертного или полуавтоматического (естественные границы, геометрические интервалы, квантили) классифицирования этого показателя на классы. В итоговом атрибутированном растре каждый пиксель либо относится (значение <span class="greencursiv">true</span> в рамках булевой логики) либо не относится  (значение <span class="greencursiv">false</span>) к конкретному классу. В рамках нечеткой логики переходы между таксонами выражают не по правилам вероятностного подхода (т.е., вне зависимости от "переломов" гистограммы распределения), а согласно графику одной из линейных или криволинейных функций (<span class="blackbold">Fuzzy Gaussian, Fuzzy Large, Fuzzy Linear, Fuzzy MS Large, Fuzzy Small</span>), значения которой (точки на прямой, точки перелома прямой, точки изгиба кривой) позволяют присвоить каждому пикселю исходного растра (в нашем примере растру уклона) показатель степени принадлежности к определенной части множества (подмножеству).</p> 

<p>Свойство принадлежности назначается по шкале от <span class="greencursiv">0</span> до <span class="greencursiv">1</span>. В этом случае, скажем, значение <span class="greencursiv">1</span> будет означать полную принадлежность к классу (например "крутой склон"), а значение <span class="greencursiv">0,60</span> - только частичную принадлежность ("скорее крутой, чем пологий"), тогда как значение <span class="greencursiv">0,00</span> с полной определенностью не относятся к подмножеству склонов "крутые".</p>  

<p>Для такой предварительной обработки значений растров переменных используется инструмент <span class="blackbold">Fuzzy Membership|Нечёткая принадлежность</span>. Таким же образом обрабатываются все остальные факторы, рассматриваемые как входные параметры модели (значения таксонов ландшафтных и вегетационных индексов, классы landuse|landcover). Далее производится нечеткое наложение <span class="blackbold">Fuzzy Overlay</span> набора привлеченных параметров. В этом смысле данный алгоритм аналогичен классическому (где на первой стадии проводится реклассификация сырых переменных - факторных растров, на второй - их комбинирование).</p>

<p>Нечеткая логика как способ обработки исходных данных и метод их переклассификации лежит в основе многих современных алгоритмов, в том числе - нейронных сетей.</p>

<p>Нечеткая логика требует экспертного участия, поскольку результаты будут напрямую зависеть от сформулированных правил. Например, пользователь решает, что в модели ландшафтов горной области должны получить отображение четыре высотных пояса, но их границы (как это всегда и бывает) не могут быть однозначно определены строгими пороговыми значениями. Тогда для каждого пояса можно задать правила соответствия приблизительно следующего вида: "пояс мелколиственных березовых лесов начинается не ниже <span class="greencursiv">1600 м</span> и никогда не заходит за высоту <span class="greencursiv">2400 м</span>, при этом типичные высота которую занимает данная растительная формация обычно находится между <span class="greencursiv">1800</span> и <span class="greencursiv">2200 м</span>". Такого вида принадлежность передается функцией принадлежности <span class="cursive">Нечеткий Гауссов (Fuzzy Gaussian)</span>.</p>

<p>Дополнительные возможности для моделирования предоставляет инструмент <span class="blackbold">Fuzzy Overlay|Нечеткого Наложения</span> позволяющий использовать  разные типы нечетких операторов <span class="cursive">(OR, AND, PRODUCT, SUM, GAMMA)</span>. Например, при обычном комбинировании растров высоты и залесенности склонов, мы получаем результаты вида "очень высокий незалесенный склон" только в случае, если в соответствующих входных растрах высота - <span class="greencursiv">True</span> и наличие леса - <span class="greencursiv">Fulse</span>.</p> 

<p>Использование  <span class="monospace">Нечеткого Наложения</span> может предоставить целый спектр результатов в зависимости от типа наложения и оператора, в одних случаях сужая искомое подмножество, в других случаях расширяя его. Так <span class="cursive">Fuzzy And|Нечеткое И </span>- определяет наиболее "жесткое" наложение при котором принадлежность и для уклона, и для залесенности <span class="greencursiv" >> =0,5</span>, что определит  минимальное вхождение исходных растров в результат. <span class="cursive">Fuzzy Or|Нечеткое Или</span>, напротив, является самым мягким условием наложения, при котором в результирующий растр войдут ячейки, у которых хотя бы одно из свойств (уклон или залесенность) <span class="greencursiv" >> =0,5</span>.</p>

<p>Рассмотренные выше подходы к сегментации рельефа, растительного покрова и характера землепользования представляются перспективными для решения  проблемы ГИС-моделирования сложных геоэкосистем, например, природных или культурных ландшафтов. В любом случае подобное моделирование должно предваряться получением ответов на два вопроса:</p><br> 
  <span class="monospace">
1) Какие исходные данные используются?<br>	 
2) Какие существующие алгоритмы наилучшим образом подходят для решения конкретной задачи?</span>.<br>

<p>Различные варианты возможных ответов на эти два вопроса могут быть (в первом приближении) сведены к двум подходам, в какой-то степени воспроизводящим экспертные техники традиционного ландшафтного картографирования. Заметим здесь, "в скобках", что вопрос о почвах мы оставляем за рамками наших рассуждений, поскольку почвоведы апробируют аналогичные алгоритмы полагая при этом, что в результате синтеза местоположений с растительным покровом они получат... <span class="bolditalic">soil`s predictible maps</span>, т.е.,  модели почвенного покрова <a href="BIBLIO.html#Kumar_2018">[Kumar, Sinha, 2018;</a> <a href="BIBLIO.html#Kirillova_2020">Кириллова, 2020]</a>.</p> 

<p><span class="bolditalic">Первый подход</span>, (пожалуй, наиболее близкий к технике классического ландшафтного картографирования), предполагает синтез двух предварительно полученных слоев: морфолитогенной основы в виде <span class="bolditalic">ландшафтных местоположений|landscape site</span> <a href="BIBLIO.html#Jasiewicz_2013">[Jasiewicz, Stepinski, 2013]</a> и биоты в виде <span class="bolditalic">классифицированных типов растительности/типов землепользования (LULC)</span> <a href="BIBLIO.html#Hansen_et_al_2022">[Hansen et al., 2022]</a>.</p>

<p><span class="bolditalic">Второй подход</span> заключается в "сборке" из более-менее обширного набора слоев, являющихся <span class="bolditalic">частными характеристиками ландшафтных местоположений и растительного покрова</span>. В рамках этого подхода можно выделить два метода, первый, когда в роли переменных для характеристики меcтоположений используются вторичные (производные) геоморфометрические переменные, а для характеристики растительного покрова — ландшафтные (в том числе вегетационные, но не только) индексы. Другой метод, разработанный в рамках второго подхода, предполагает агрегирование, с одной стороны,  относительно большого числа первичных (локальных) метрик, (уклон, экспозиция, различные виды кривизны, индекс конвергенции и т.д.), с другой -  отдельных каналов космических снимков или неклассифицированных вегетационных индексов.</p>  

<p>Различие между этими вариантами в том, что в случае привлечения большого числа первичных метрик мы в большей степени устраняемся от экспертного участия, каковое включает переклассификацию, т.е., дифференциацию сложных переменных посредством выбора числа и пороговых значений классов. Ведь если значение <span class="monospace">индекса топографической позиции</span> является отражением гребне-килевой дифференциации, то <span class="monospace">высота, уклон, профильная/горизонтальная кривизна</span> характеризуют первичные параметры данной точки поверхности, и, следовательно мы перепоручаем полуавтоматическому ГИС-алгоритму больший объем "работы" по компоновке итоговых таксонов получаемого в итоге прототипа ландшафта.</p>

<p>Таким образом, два потенциальных подхода к ГИС-моделированию геоэкосистем различаются по нескольким основаниям:</p>

<ol>
<li>степени вовлечения экспертного знания (максимально — в первом, минимально — во втором);</li>
<li>прозрачности процесса моделирования (в первом случае мы можем судить о том, из каких именно исходных классов биоты и ландшафтных местоположений образовались конечные классы ландшафтов, во втором — перед нами условно "серый ящик", хотя по таблицам статистики, скажем, в случае кластерного анализа мы можем установить дифференцирующую роль и значения всех привлеченных параметров);</li>
<li>числу используемых для делимитации и классификации слоев-переменных, характеристик ландшафтных местоположений, биоты и землепользования (первый подход — две, второй — от 3-6 до более чем 5-8);</li>
<li>сложности интерпретации результатов.</li>
</ol>


<p>Инструменты, выбираемые для ГИС-моделирования могут быть условно разделены на <span class="bolditalic">воспроизводящие традиционные экспертные техники</span> и <span class="bolditalic">инновационные</span>, связанные с современными методами кластеризации, группирования и машинного обучения.</p>

<p>К воспроизводящим привычные экспертные алгоритмы относится простое наложение признаков - комбинированием с помощью инструмента <span class="blackbold">Combine</span>. Достоинство этого метода заключается в его традиционности: у пользователя возникает ощущение, что конечные классы можно получить в результате операции, представляющей собой алгебру матриц. Каждая точка пространства получает набор характеристик, которые могут быть объединены конкатенацией в составной индекс. Однако этот алгоритм пригоден только для первого подхода - сочетания "предуготовленных" классов ландшафтных местоположений с классами растительного покрова/землепользования. "Родовые" недостатки наложения комбинированием мы упоминали выше: возникновение некоторого числа ничтожных классов, сложный и некорректный характер границ и т.д.</p>

<p>Однако, наибольшие перспективы связаны с современными алгоритмами кластеризации, которые в первом приближении могут быть разделить на две крупных категории: <span class="bolditalic">полуавтоматические (Unsupervasied)</span> методы и <span class="bolditalic">контролируемые (Supervasied)</span> методы классификации.</p>

<p>Полуавтоматические алгоритмы классификации:<br>
	<ul>
<li>Иерархический кластерный анализ,</li>
<li>K-Means кластеризация,</li>
<li>ISODATA кластеризация.</li>
</ul>
</p>
<p>Контролируемые алгоритмы классификации (с обучением):</p>
<ul>
<li>Дискриминантный анализ,</li>
<li>Деревья классификации,</li>
<li>Нейронная сеть прямого распространения,</li>
<li>Случайный лес,</li>
<li>Наивный байесовский классификатор.</li></ul>
</p>

<p>Все перечисленные методы, в принципе, могут примениться в рамках любого из  описанных выше подходов, однако результаты всякий раз будут в существенной степени зависеть от учитываемых факторов, состава и качества исходных слоев, масштаба, сложности классификаторов исходных тематик и т.д.</p>
<br>

<h3 id="h3_4">15.4. Первый подход: синтез готовых классификаций ландшафтных местоположений и биоты</h3>

<p>Для ознакомления с возможностями первого подхода попытаемся соединить результаты классификации ландшафтных местоположений с классификацией растительного покрова и землепользования для моделирования прототипов природных ландшафтов. В качестве исходных используем полученные ранее (см. разделы <a href="book_3_11.html">11</a> и <a href="book_3_13.html">13</a>) слои сегментированного рельефа (K-means cluster classification по семи морфометрическим переменным в <span class="blue">SAGA GIS</span> - <a href="#KMeans_Clusters16_R_7_factor_map">Рис. 15.9a</a>)  и автоматического дешифрирования изображения Landsat 8 (Неконтролируемая кластеризация на основе каналов SWIR2-NIR Red-Green - <a href="#clusterKmeans14_hillclmb">Рис. 15.9b</a>) на ключевую территории Приэльбрусья, для которой существует <a href="#landcarta">ландшафтная карта</a> выполненная обычным традиционным способом (авторы А.Н.Гуня и М.Н.Петрушина).</p>


<div class="script_01">
<figure>
<a id="KMeans_Clusters16_R_7_factor_map"><img src="Pict_3_15/KMeans_Clusters16_R_7_factor_map.png"  width="350"></a>
</figure>
<figure align=right>
<a id="cKMeans_Clusters16_R_7_factor_Lp"><img src="Pict_3_15/KMeans_Clusters16_R_7_factor_Lp.png" width="70"></a>  
</figure>
</div>

<div class="script_01">
<figure>
<a id="clusterKmeans14_hillclmb"><img src="Pict_3_15/clusterKmeans14_hillclmb.png"  width="350"></a>
</figure>
<figure align=right>
<a id="clusterKmeans14_hillclmbL"><img src="Pict_3_15/clusterKmeans14_hillclmbL.png"width="70"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.9 Исходные растры сегментации: a) ландшафтных местоположений - 16 классов, b) состояний биоты и землепользования - 14 классов

<p>Традиционное (как в классическом ландшафтоведении) наложение комбинированием может быть осуществлено тремя алгоритмами  геоинформационного моделирования: <span class="blackbold">Combine</span> (комбинированием), <span class="blackbold">Multiply</span> (умножением в калькуляторе растров), и <span class="blackbold">Fuzzy Overlay</span> (нечетким наложением). </p>

<div class="script_01">
<figure>
<a id="Multiply_Grids_R_L_map"><img src="Pict_3_15/Multiply_Grids_R_L_map.png"  width="150%" height="relative"></a>
</figure>
<figure align=right>
<a id="clusterKmeans14_hillclmbL"><img src="Pict_3_15/Multiply_Grids_R_L_L.png" width="12%" height="relative"></a>  
</figure>
</div>
<br><span class="imgtitle">Рис. 15.10 Результат оверлея растров  рельефа и биоты инструментом Multiply  в <span class="blue">SAGA GIS</span> - 224 классов</p>

<p>Перемножение 14 классов растительного покрова/землепользования и 16 классов рельефа образует <a href="#Multiply_Grids_R_L_map">мозаику из 224 классов</a>, которые достаточно сложно интерпретировать, если не применить один из способов группирования классов.</p>
<p>Аналогичный результат получим оверлеем способом <span class="blackbold">Combine</span> в <span class="red">ArcMAP10.x</span></p>


<table id="customers">
   <table border="0" width="100%">
       <tr>
    <td><a id="combine_R_L_row"><img src="Pict_3_15/combine_R_L_row.png" width="100%" height="relative"></a></td>
    <td><a id="combine_R_L_fb"><img src="Pict_3_15/combine_R_L_fb.png" width="100%" height="relative"></a></td>
      </tr>
</table>

<br> 
<span class="imgtitle">Рис.15.11 Результат оверлея растров рельефа и биоты методом Combine в <span class="red">ArcMAP10.x</span>:  a) сырой комбинированный растр - 224 класса, b) растр после чистки и генерализации алгоритмами Focal statistic и Boundary Clean - 222 класса</p>

<p>Самостоятельный интерес представляет картина <span class="bolditalic">частотного распределения классов</span>, которая отображается на вкладке <span class="cursive">Classify</span> оформления слоя <span class="red">ArcMAP10.x</span> и позволяет обнаружить три-четыре иерархических уровня организации ландшафта, связанных, вероятно, с горным массивом Эльбруса, широтно вложенной долиной Баксана, главными боковые хребтами и долинами северо-западного и юго-восточного простирания, крупными контрфорсами хребтов и небольшими ущельями, и, наконец, отдельными склонами и распадками между ними.</p>

<a id="combine_R_L_frequency"><img src="Pict_3_15/combine_R_L_frequency.png" width="70%" height="relative"></a> <br>
<span class="imgtitle">Рис. 15.12 Гистограмма распределения итоговых классов наложения ландшафтных местоположений и состояния биоты и землепользования

<p>Аналогичное действие может быть произведено с двумя векторными полигональным слоями - ландшафтных местоположений и состояний - с помощью инструмента <span class="blackbold">Identity|Идентичность</span> (в <span class="red">ArcMAP10.x</span>: <span class="monospace">Analyst Tools >> Overlay >> Identity</span>). При использовании опции <span class="cursive">join_attributes=ALL</span> атрибутивные значения из входных классов пространственных объектов будут скопированы в выходной класс. Конкатенацией исходных кодов можно получить комплексный индекс. Результат векторного пересечения аналогичен комбинированию растров - 224 класса.</p>

<a id="R_L_Identity_table"><img src="Pict_3_15/R_L_Identity_table.png" width="55%" height="relative"></a> <br>
<span class="imgtitle">Рис.15.13 Таблица векторного слоя пересечения полигонов инструментом Идентичность

<p>Далее полигоны можно классифицировать и свести к необходимому числу классов используя  один из инструментов кластеризации: <span class="blackbold">Grouping Analysis|Анализ Группирования </span><span class="red">ArcMAP10.x</span> или <span class="blackbold">K-means cluster classification</span> <span class="blue">SAGA GIS</span> и последующее <span class="blackbold">Dissolve|Cлияние</span> полигонов по номеру группы или кластера.</p>	

<div class="script_01">
<figure>
<a id="Identity_GroupAnal_Diss_Ell"><img src="Pict_3_15/Identity_GroupAnal_Diss_Ell.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Identity_GroupAnal_Diss_Ell_leg"><img src="Pict_3_15/Identity_GroupAnal_Diss_Ell_leg.png" width="15%" height="relative"></a>  
</figure>
</div>
<span class="imgtitle">Рис. 15.14 Группы слоя пересечения двух полигонов Identity  после обработки инструментом Eliminate для удаления мелких объектов

<p>Обобщая опыт синтеза простым наложением, можно отметить, что <span class="bolditalic">алгоритм классического ландшафтного оверлея сохраняет дидактическое (т.е., обучающее) значение, но степень его пригодности уменьшается пропорционально сложности привлеченных растров ландшафтных местоположений и ландшафтного покрова, т.е., пропорционально увеличению площади и усложнению разнообразия сцены моделирования.</span></p>

<p>Нестрогим (в терминологии ГИС-моделирования) экспертным вариантом комбинирования можно считать алгоритм "подстановки" дополнительной характеристики к "основной": когда (согласно технике ландшафтного картографирования ленинградской школы <a href="BIBLIO.html#Isa1999">[Исаченко,  1999])</a> за базовый признак принимаются ландшафтные местоположения, а биота рассматривается как инвариант состояния. Для воспроизведения этого метода в рамках ГИС-модели значения (классы) биоты могут быть извлечены в предварительно построенную матрицу ландшафтных местоположений. Если оба слоя (слой местоположений и слой состояния биоты) - полигональные векторы, то может быть использован алгоритм <span class="blackbold">Identity|Идентичность</span> ; в варианте с растрами вычисляется <span class="blackbold">Zonal Statistic|Зональная статистика</span> слоя состояния биоты по слою ландшафтных местоположений. </p>

<p>Инструмент <span class="red">ArcMAP10.x</span> <span class="blackbold">Zonal Statistic</span>  (<span class="monospace">Spatial Analyst Tools >> Zonal >> Zonal Statistic</span>) <span class="red">ArcMAP10.x</span> содержит две опции: в поле <span class="cursive">Zonal Field|Поле Зоны</span> - следует указать уникальный идентификатор полигонов (но не gridcode!) и опцию  <span class="cursive">Statistic Type|Тип Статистики</span>. Последняя принципиально важна: в пределах любого конкретного полигона местоположений могут оказаться ячейки растра, принадлежащие к разным классам состояния ландшафта (<span class="monospace">LULC</span>) - двум-трем и более. При "интуитивном" рисовании по двум калькам (местоположений и биоты) эксперт принимает индивидуальное решение в каждом конкретном случае, в варианте ГИС-моделирования мы должны предположить - на что больше похожа такая интуиция, т.е., выбрать тип статистики: <span class="cursive">"MEAN|СРЕДНЕЕ АРИФМЕТИЧЕСКОЕ", "MEDIAN|МЕДИАНА" или "MAJORITY|БОЛЬШИНСТВО"</span>.</p>

<div class="script_01">
<figure>
<a id="R_L_zonal7_major"><img src="Pict_3_15/R_L_zonal7_major.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="R_L_zonal7_major_Leg"><img src="Pict_3_15/R_L_zonal7_major_Leg.png" width="20%" height="relative"></a>  
</figure>
</div>
<span class="imgtitle">Рис. 15.15 Растр 15-ти итоговых классов зональной статистики LULC по полигонам местоположений с опцией тип статистики MAJORITY|БОЛЬШИНСТВО

<p>Преимущества этого метода перед простым оверлеем (комбинированием) очевидны, и в целом подобное решение не так далеко от традиционного ландшафтного картографирования. Обратим внимание, что извлечение зональной статистики оказывает влияние на форму мозаики итогового растра, чтобы в этом убедиться достаточно сравнить полученный растр зональной статистики с векторными контурами ландшафтных местоположений и состояний ландшафта.</p>

<table id="customers">
   <table border="0" width="100%">
       <tr>
    <td><a id="R_L_zonal7_majo_контур_рельефа"><img src="Pict_3_15/R_L_zonal7_majo_контур_рельефа.png" width="100%" height="relative"></a></td>
    <td><a id="R_L_zonal7_majo_контур_растительности"><img src="Pict_3_15/R_L_zonal7_majo_контур_растительности.png" width="100%" height="relative"></a></td>
      </tr>
</table>


<span class="imgtitle">Рис. 15.16 Итоговый растр зональной статистики: а)  с контурами ландшафтных местоположений, b) с контурами  состояний ландшафта (LULC)

<p>Слой состояний ландшафта (растительного покрова/землепользования) не влияя на очертания границ отдельных полигонов слоя ландшафтных местоположений интегрирует полигоны с одинаковыми значениями, что приводит к формированию более обобщенного рисунка контуров <a href="#R_L_zonal7_majo_контур_рельефа">(Рис. 15.16)</a>.</p>

<table id="customers">
   <table border="0" width="100%">
    <tr>
    <td><a id="R_L_проверка_синтеза_1_Гуня"><img src="Pict_3_15/R_L_проверка_синтеза_1_Гуня.png" width="100%" height="relative"></a></td>
    <td><a id="R_L_проверка_синтеза_1_zonal7majori"><img src="Pict_3_15/R_L_проверка_синтеза_1_zonal7majori.png" width="100%" height="relative"></a> </td>
  </tr>
</table>

<br>
<span class="imgtitle">Рис. 15.17 Сравнение растра зональной статистики состояний ландшафта по полигонам ландшафтных местоположений с экспертной ландшафтной картой

<p>Сравнение растра зональной статистики состояний ландшафта по полигонам ландшафтных местоположений с экспертной ландшафтной картой показывает неплохое сходство <a href="#R_L_проверка_синтеза_1_Гуня">(Рис. 15.17)</a>. Многие контуры лесных и степных ландшафтов, практически идентичны, что обусловлено высокой степенью связи ландшафтных местоположений, приуроченных к мезоформам рельефа и типа растительности: например, на склонах южных экспозиций — степи, а на склонах северной экспозиции — леса. Также схожи контуры ландшафтов с отсутствием или очень слабым развитием растительности: гляциальные на привершинных поверхностях и субнивальные луговые на верхних склонах хребтов.</p>

<p><span class="blackbold">Fuzzy Overlay|Нечеткое наложение</span></span> может рассматриваться как еще один алгоритм синтеза морфолитогенной основы и биоты ландшафта. Инструменты <span class="monospace">Нечеткого наложения</span> присутствуют как в <span class="red">ArcMAP10.x</span> (<span class="blackbold">Spatial Analyst Tools  >>  Overlay  >>  Fuzzy Overlay</span>), так и в <span class="blue">SAGA GIS</span> (<span class="blackbold">Grid  >>  Calculus >> Fuzzy Intersection</span>). В обеих ГИС пользователю необходимо выбрать <span class="cursive">Overlay type|Тип наложения</span>; инструмент <span class="blackbold">Fuzzy Overlay</span> <span class="red">ArcMAP10.x</span> предоставляет здесь больше возможностей.</p>

<p>Выбор <span class="cursive">типа наложения</span> открывает спектр вариантов объединения данных, базирующихся на анализе теории множеств:</p> 
<ul>
<li><span class="cursive">AND|И</span>,</li>
<li><span class="cursive">Or|Или</span>, </li>
<li><span class="cursive">Product|Произведение</span>,</li>
<li><span class="cursive">Summ|Сумма</span>,</li>
<li><span class="cursive">Gamma|Гамма</span>.</li>
</ul>
 
<p>Для ситуации, в которой входными данными являются уже определенные классы (ландшафтных местоположений и состояния ландшафта),  мы не можем воспользоваться методами <span class="cursive">Fuzzy Summ</span> (линейная комбинационная функция даст около 200 классов) и <span class="cursive">Fuzzy Product</span> (перемножает значения входных ячеек и без предварительного определения Нечеткой принадлежности является полным аналогом процедуры <span class="blackbold">Combine</span>).</p>

<p><span class="blackbold">Fuzzy And</span> определяет своего рода общее минимальное значение для принадлежности "пригодности" всех входных переменных, соответственно число итоговых классов будет равно числу классов растра с минимальным количеством таксонов - в данном случае это <span class="greencursiv">14 классов</span> <span class="monospace">ландшафтных состояний</span>. <span class="blackbold">Fuzzy Or</span>, напротив, возвращает максимальное значение наборов, к которым относится местоположение ячейки, и, следовательно, число классов будет эквивалентно числу классов растра с максимальным количеством таксонов (<span class="greencursiv">16 классов</span> <span class="monospace">ландшафтных местоположений</span>).</p>

<table id="customers">
   <table border="0" width="100%">
    <tr>
    <td><a id="R_L_Fuzzy_AND"><img src="Pict_3_15/R_L_Fuzzy_AND.png" width="100%" height="relative"></a></td>
    <td><a id="R_L_Fuzzy_OR"><img src="Pict_3_15/R_L_Fuzzy_OR.png"  width="100%" height="relative"></a> </td>
  </tr>
</table>
<br>
<span class="imgtitle">Рис. 15.18 Синтез ландшафтных местоположений и состояний ландшафта методом Fuzzy overlay: a) Fuzzy AND|Нечеткое И, b)  Fuzzy OR|Нечеткое ИЛИ

<p>Сравнивая два типа <span class="monospace">Нечеткого наложения</span> можно заметить, что <span class="blackbold">Нечеткое ИЛИ</span>  лучше сохраняет целостность долинно-речной и эрозионной сети. Однако оба варианта достаточно далеки от экспертной карты, что свидетельствует о несхожести нечеткой логики с логикой традиционного ландшафтного картографирования.</p>

<p>Более сложные решения (уже выходящие за рамки традиционных методов ручного картографирования) проблемы синтеза морфолитогенной основы ландшафта и биоты предполагают использование алгоритмов кластерного анализа (неконтролируемого и с обучением), а также методом классификации максимального подобия и искусственной нейронной сети.</p>

<p>К неконтролируем методам классификации относятся так называемый <span class="blackbold">Изокластерный анализ</span> и <span class="blackbold">К-means классификация</span>. Инструменты изокластерного анализа выполняет неконтролируемый алгоритм классификации (Isodata, что означает Self-Organizing Data Analysis Techniques|Итеративные Методы Самоорганизующегося анализа данных): сложный алгоритм автоматически разбивающем пиксели композитного растрового слоя на определенное число таксонов ("классов"), имеющих сходные "спектры" по всей совокупности использованных выходных переменных, когда в каждом данном таксоне по конкретной переменной значения пикселей близки, а стандартные отклонения и дисперсии невелики; операция повторяется несколько раз, чтобы в конечном итоге создать сегментированное изображение, и может дополнительно генерировать файл "спектральной" <span class="monospace">сигнатуры</span>, содержащий характеристики  каждого класса <a href="BIBLIO.html#Memarsadeghi_et_al._2007">[Memarsadeghi et al., 2007]</a>.</p>

<p> В <span class="blue">SAGA GIS</span> <span class="monospace">ISODATA Clustering for Grids|Изокластерный анализ для гридов</span> позволяет использовать ряд опций, которые заметно влияют на итоговый результат.</p>

<div class="script">
	
Data Objects <br>
Grid systems: ...<br>
 >>  Features: LULC, Landscape sites<br>
<< Clusters: Create<br>

Tables <br>
<< Statistic: Create<br>
Option<br>

Normalize: check <br>
Maximum Number of iterations: 20<br>
Initial Number of Clusters: 12<br>
Maximum Number of Clusters: 16 <br>
Mininal Number of Samles in a Cluster: (*минимальное число образцов для отдельного кластера) 12 <br>
Start Partition: (*порядок разбиения на кластеры) random<br>

</div>

<p>Однако реальное число выходных кластеров в <span class="blue">SAGA GIS</span> определяется самим алгоритмом - повлиять на него можно лишь косвенно (в зависимости от входных данных), увеличивая число максимальных классов.</p>

<div class="script_01">
<figure>
<a id="ISO_Lndst_KmnsRsaga"><img src="Pict_3_15/ISO_Lndst_KmnsRsaga.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="ISO_Lndst_KmnsRsagaLEG"><img src="Pict_3_15/ISO_Lndst_KmnsRsagaLEG.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.19 Синтез ландшафтных местоположений и состояний ландшафта методом алгоритмом ISODATA Clustering SAGA

<p>Инструмент пакеты <span class="red">ArcMAP10.x</span> <span class="blackbold">Iso Cluster Unsupervised Classification</span> <span class="monospace">(Spatial Analyst >> Multivariate)</span>  сочетает в себе функциональные возможности собственно изокластерного анализа  и <span class="blackbold">Maximum Likelihood|Классификации максимального правдоподобия</span>. Критические опции: <span class="cursive">Number of classes|Число классов,  Minimum number of cells in a valid class|Значение минимального числа ячеек,</span> представляющих класс (по умолчанию - <span class="greencursiv">20</span>) и <span class="monospace">Sample interval|Расстояние между сеянными образами</span>. Первая опция позволяет регулировать величину ареалов выходных классов,  вторая повлияет на текстуру выходного файла. Изокластерный анализ <span class="red">ArcMAP10.x</span> имеет преимущество перед аналогичным алгоритмом <span class="blue">SAGA GIS</span> поскольку позволяет контролировать главную опцию - число классов.</p>

<div class="script_01">
<figure>
<a id="isoclst_arc_13_defoult"><img src="Pict_3_15/isoclst_arc_13_defoult.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="isoclst_arc_13_defoultleg"><img src="Pict_3_15/isoclst_arc_13_defoultleg.png" width="18%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.20 Синтез ландшафтных местоположений и состояний ландшафта методом алгоритмом ISODATA ArcMAP 10.x

<p>Алгоритм изокластерного анализа по своему содержанию достаточно сложен, именно поэтому он позволяет получить сравнительно корректный, близкий к экспертному рисованию результат: неплохо выделены привершинные поверхности массива Эльбруса, хорошо передана локальная (контрфорсы - распадки) гребне-килевая дифференциация склонов. К погрешностям метода можно отнести нарушенную структуру долинно-речной и эрозионной сети.</p>

<p>Собственно кластерный анализ может быть проведен с помощью инструмента <span class="blackbold">K-Means Clustering for Grids</span>  <span class="blue">SAGA GIS</span>. Критичными опциями являются число кластеров, <span class="cursive">Method|Метод</span>, и <span class="cursive">Start Partition|Порядок дифференциации</span>.</p>

<div class="script_01">
<figure>
<a id="KmeansCl_R_L_14.sdat"><img src="Pict_3_15/KmeansCl_R_L_14.sdat.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="KmeansCl_R_L_14.sdat_leg"><img src="Pict_3_15/KmeansCl_R_L_14.sdat_leg.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.21 Синтез ландшафтных местоположений и состояний ландшафта методом алгоритмом K-Means Clustering for Grids SAGA GIS

<p>Теоретически результат кластеризации может быть оптимизирован с использованием принципиально иного инварианта кластеризации - кластеризации с обучением. Инструменты подобного рода присутствуют во всех популярных ГИС, в <span class="blue">SAGA GIS</span> это <span class="blackbold">Supervised Classification for Grids</span> <span class="monospace">(Imagery >> Classification)</span>, в <span class="red">ArcMAP10.x</span> - близкий по алгоритму инструмент <span class="blackbold">Classify Raster</span>.</p>

<p><span class="blackbold">Классификация с обучением</span> требует предварительного создания файла "затравок" или образцов предполагаемых классов. В нашем случае они могут быть получены путем формирования векторного слоя точек в центрах ареалов экспертной ландшафтной карты и последующим превращением точечного файла в полигональный посредством инструмента <span class="blackbold">Buffer</span>.</p>

<div class="script_01">
<figure>
<a id="обучающий_точки_карта"><img src="Pict_3_15/обучающий_точки_карта.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="обучающий_точки_лег"><img src="Pict_3_15/обучающий_точки_лег.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.22 Полигональный файл обучающих образцов -  небольших окружностей, полученных буферизацией центроидов векторных контуров обводки исходной экспертной ландшафтной карты


<p>Инструмент <span class="blackbold">Supervised Classification for Grids</span> <span class="blue">SAGA GIS</span> содержит несколько опций, из которых критичны <span class="cursive">Method|Метод</span> (предлагается семь вариантов) и <span class="cursive">Probability Reference|Способ соотнесения с образцом</span>  (абсолютный и относительный).</p>


<table id="customers">
   <table border="0">
       <tr>
    <td><a id="SupClass_Max_Like_R_L_Kmeans_sagamap"><img src="Pict_3_15/SupClass_Max_Like_R_L_Kmeans_sagamap.png"  width="300"></a></td>
    <td><a id="SupClass_Max_Like_R_L_Kmeans_sagaLeg"><img src="Pict_3_15/SupClass_Max_Like_R_L_Kmeans_sagaLeg.png" width="50"></a> </td>
    <td><a id="SupClass_Max_Like_R_L_Kmeans_sagaWinner"><img src="Pict_3_15/SupClass_Max_Like_R_L_Kmeans_sagaWinner.png"  width="300"></a></td>
    <td><a id="SupClass_Max_Like_R_L_Kmeans_sagaWinnerLeg"><img src="Pict_3_15/SupClass_Max_Like_R_L_Kmeans_sagaWinnerLeg.png" width="50"></a></td>
       </tr>
</table>

<br>
<span class="imgtitle">Рис. 15.23 Результаты кластеризации в <span class="blue">SAGA GIS</span> с обучением: а) с опциями Method - Maximum Likelihood и Probability Reference - Relative, b) Method - Winner Takes all, Probability Reference - Absolute

<p>Выходные классы <span class="blackbold">классификации с обучением</span> соответствуют набору таксонов обучающего файла по числу и сохраняют семантику (номенклатуру) классов. Результат может оказаться разочаровывающим - как в данном случае. Отчасти это может объясняться малым количеством "затравок" и небольшой площадью их ареалов, однако может существовать и более серьезная проблема - выбранные для затравок "точки" являются на самом деле плохой "репрезентацией" экспертных действий, иными словами - они не являются "ядрами" типичности в каждом конкретном классе.</p>

<p>Наконец, еще один вариант синтеза с использование обучения, который приобретает все большую популярность - классификация по алгоритму Нейронных Сетей - <span class="blackbold">Neural Network Classification</span> <span class="monospace">(Imagery >> OpenCV >> Artificial)</span>, реализованному в <span class="blue">SAGA GIS</span> и представляющему собой интеграцию библиотеки машинного обучения <span class="blackbold">OpenCV</span> для классификации гридов. Инструмент сложен в использовании и предполагает тщательную настройку опций способом "проб и ошибок".<br>

<div class="script">
	<b>Data Objects</b><br>
	Grids<br>
	Grid systems: ....<br>
	 >>  Features: LULC, Landscape sites<br>
<< Clusters: Create<br>
 <look-up table: not set> <br>
<b>Options</b><br>
Load Model <br>
	Model Training <br>
 >>  Training Areas: Points_Landscape_Buff<br>
	Class Identifier:  Ind<br>
	Save Model <br>
	Number of Layers: 3 *Число слоев в нейронной сети (за исключением входных, варианты от 1 до 3<br>
	Number of Neurons: 3 *Число нейронов в каждом слое сети, целое число от 1 до 3<br>
	Maximum Number of Iteration: 300 *Максимальное Число Итераций<br>
  Activation Function: Identity *Используемая Функция (Identity, Sigmoid, Gaussian)<br>
<b>Training Method</b>: back propagation *Метод Обучения (resilient propagation, back propagation)<br>
	Weight Gradient Term: 0,1<br>
	Moment Term: 0,1<br>
</div>


<p>Также как и в случае кластеризации с обучением, результат работы алгоритма <span class="blackbold">Neural Network Classification</span> по образцам-затравкам далек от экспертной ландшафтной карты, и несмотря на сохраненную семантику легенды на самом деле презентует всего 7 классов (остальные, по всей вероятности "элиминируются" в процессе выполнения скрипта как ничтожные).</p>

<div class="script_01">
<figure>
<a id="ArtiNeurNetClasSaga_R_L"><img src="Pict_3_15/ArtiNeurNetClasSaga_R_L.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="ArtiNeurNetClasSaga_R_L"><img src="Pict_3_15/ArtiNeurNetClasSaga_R_L_leg.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.24 Результат синтеза морфолитогенной основы и состояний ландшафтов с помощью инструмента  Искусственная нейронная сеть в SAGA GIS

<p>Таким образом ГИС-моделирование ландшафтов на основе двух классифицированных растров, (один из которых отображает дифференциацию морфолитогенной основы, а другой - растительный покров и виды землепользования) может быть осуществлено с использованием разных алгоритмов. Методы, которые, казалось бы, логически отражают последовательность действий при экспертном картографировании (простой оверлей слоев комбинированием) приводят к плохо интерпретируемым результатам с избыточным числом классов и общим высоким уровнем информационного шума. В качестве паллиативного можно рассматривать оверлей алгоритмом <span class="blackbold">Идентичность</span> с последующим группированием классов. В том случае, если поставлена задача максимально приблизиться к конфигурации экспертно-мануальной карты, вероятно, оптимальным вариантом является <span class="blackbold">Зональная Статистика</span> растра ландшафтных состояний по полигонам ландшафтных местоположений. </p>

<p>Более сложные методы неконтролируемой классификации - такие как <span class="blackbold">К-среднее Кластерный Анализ</span>	  и <span class="blackbold">Изокластерный Анализ</span>, дают результаты, представляющие самостоятельный интерес (с точки зрения их соответствия сложному набору ландшафтообразующих факторов), но мало сравнимый с экспертной картой - прежде всего по подробности итоговой мозаики и точности изображения. Классификация с обучением не позволяет радикально оптимизировать результат кластерной классификации ни в случае кластерного анализа, ни в случае применения искусственных нейронных сетей, поскольку итогом обучения является примитивизация изображения, утрата ряда классов и преувеличение роли и ареалов оставшихся таксонов. </p>
<br>


<h3 id="h3_5">15.5. Второй подход: синтез набора различных переменных, характеризующих признаки ландшафтных местоположений и состояний ландшафта</h3>


<p>Возможности второго подхода связаны с использованием набора из нескольких переменных, характеризующих те или иные свойства ландшафтных местоположений растительного покрова и землепользования (т.е., состояний ландшафта). Подобная методика требует живого участия эксперта, прежде всего, в выборе переменных, и только затем - в определении способа их интеграции. Очевидно, что и то, и другое, не может быть установлено "раз и навсегда": <span class="bolditalic">набор переменных будет зависеть от особенностей региональной ландшафтной дифференциации, а способ интеграции - от масштаба сцены, целей моделирования и требований к конечным (выходным) данным</span>.</p>

<p>Интеграция нескольких слоев не может быть решена средствами простого (комбинирование, идентичность) или сложного (зональная статистика) оверлея. Перспективными здесь являются алгоритмы кластерного и изокластерного анализа, нечеткого наложения с предварительной обработкой входных переменных инструментом нечеткой принадлежности и алгоритмы искусственных нейронных сетей. Попытаемся продемонстрировать такого рода "ландшафтный синтез" используя в качестве переменных геоморфометрические показатели, ландшафтные и вегетационные индексы.</p>

<p>Как мы уже могли убедиться <span class="blackbold">Изокластерный анализ</span> является одним из способов выделения классов на основе нескольких переменных. <span class="blackbold">ISODATA Clustering for Grids</span> <span class="blue">SAGA GIS</span> позволяет выявить таксоны без точного указания оператором числа конечных классов: можно лишь определить минимальное и максимальное значение. Естественно результат  будет весьма чувствительным к набору переменных и их количеству: продемонстрируем это обстоятельство на трех примерах.</p>

<p>В первом примере проведем анализ для семи переменных, пять из которых определяют ландшафтные местоположения, два - растительный покров и землепользование:</p>

<ol>
<li>Relative Slope Position|Относительное положение на склоне,</li>
<li>Slope|Уклон поверхности,</li>
<li>Maximum Curvature|Максимальная кривизна,</li>
<li>Minimal Curvature|Минимальная кривизна,</li>
<li>Positive Openness|Положительная открытость,</li>
<li>IPVI, Infrared Percentage Vegetation Index|Инфракрасный вегетационный индекс,</li>
<li>NDWI, Normalised Differentiated Water Index|Нормализованный дифференцированный водный индекс. </li>
</ol>

<div class="script_01">
<figure>
<a id="Many_isocl_01.sdat"><img src="Pict_3_15/Many_isocl_01.sdat.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Many_isocl_01.sdat_leg"><img src="Pict_3_15/Many_isocl_01.sdat_leg.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.25 Первый вариант синтеза семи слоев по алгоритму ISODATA Clustering for Grids SAGA GIS

<p>В следующем примере увеличим число и изменим, частично, состав переменных:</p>

<ol>
<li>Normalized Height|Нормализованная высота,</li>
<li>Slope|Уклон поверхности,</li>
<li>Openness|Общая открытость,</li>
<li>Valley Depth|Глубина долин,</li>
<li>Maximum Curvature|Максимальная кривизна,</li>
<li>Minimal Curvature|Минимальная кривизна,</li>
<li>IPVI, Infrared Percentage Vegetation Index|Инфракрасный вегетационный индекс,</li>
<li>NDWI, Normalised Differentiated Water Index|Нормализованный Дифференцированный Водный Индекс,</li>
<li>NDMI, Normalized Difference Moisture Index|Стандартизованный Индекс Различий Увлажненности.</li>
</ol>

<div class="script_01">
<figure>
<a id="Many_isocl_02.sdat"><img src="Pict_3_15/Many_isocl_02.sdat.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Many_isocl_02.sdatLeg"><img src="Pict_3_15/Many_isocl_02.sdatLeg.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.26 Второй вариант синтеза девяти слоев по алгоритму ISODATA Clustering for Grids SAGA GIS

<p>Преимущество любых видов кластерного анализа (в частности <span class="blackbold">ISIDATA классификации</span> или  <span class="blackbold">K-means классификации</span>) - возможность получить характеристики итоговых таксонов в виде таблицы статистик <span class="cursive">Means|Среднее</span> и <span class="cursive">StDev|Стандартное отклонение</span>; последний параметр может быть полезен как показатель близости ("кучности") значений внутри группы.</p>

<a id="Many_isocl_02.sdat_TableExcel"><img src="Pict_3_15/Many_isocl_02.sdat_TableExcel.png" width="80%"></a>
<br>
<span class="imgtitle">Рис. 15.27 Таблица средних значений 17 кластеров  второго варианта (по девяти переменным) ISODATA Clustering for Grids SAGA GIS

<p>В третьем варианте уменьшим число переменных, отражающих ландшафтные местоположения за счет введения более сложного  нелокального показателя — <span class="monospace">индекса топографической позиции</span> и введем ландшафтный индекс <span class="monospace">NDSI</span>, специально предназначенный для выделения ледовых и снежных поверхностей.</p>

<ol>
<li>Topographical Index|Индекс топографической позиции,</li>
<li>Slope|Уклон поверхности,</li>
<li>Openness|Общая открытость,</li>
<li>Convergence Index|Индекс схождения,</li>
<li>IPVI, Infrared Percentage Vegetation Index|Инфракрасный вегетационный индекс,</li>
<li>NDMI, Normalized Difference Moisture Index|Стандартизованный индекс различий увлажненности,</li>
<li>NDSI, Normalized Difference Snow Index|Стандартизованный индекс индекс различий снежного покрова.</li>
</ol>

<div class="script_01">
<figure>
<a id="Many_isocl_03.sdat"><img src="Pict_3_15/Many_isocl_03.sdat.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Many_isocl_03.sdatLeg"><img src="Pict_3_15/Many_isocl_03.sdatLeg.png"width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.28 Третий вариант синтеза семи слоев по алгоритму ISODATA Clustering for Grids SAGA GIS

<p>Сравним полученные варианты кластеров. Первый вывод, который можно сделать: <span class="bolditalic">число привлеченных растров-переменных влияет на количество конечных классов - чем больше переменных, тем большее число итоговых таксонов</span> (<span class="greencursiv">15</span> - для семи переменных в первом случае, <span class="greencursiv">17</span> - для девяти во втором). Качество привлеченных растров также оказывает влияние: <span class="bolditalic">сложные комплексные переменные с классифицированными значениями уменьшают число итоговых таксонов</span>. Так введение <span class="monospace">Индекса топографической позиции</span> в третьем примере сократило число таксонов до <span class="greencursiv">12</span>. <span class="bolditalic">Замена или добавление даже единственной переменной в набор, подвергающийся кластерному анализу, заметно меняет мозаику итоговой классификации</span>. Так, и первая, и вторая классификация хорошо передают элементы долинно-речной и эрозионной сети, а также катерную (склоновую) дифференциацию. Присутствие двух видов кривизны позволяет разделить склоны на локальные контрфорсы и тальвеги (распадки) между ними. Однако замена <span class="monospace">Относительного положения на склоне </span>на <span class="monospace">Нормализованную высоту</span> фактически убирает дифференциацию склонов массива Эльбруса. <span class="bolditalic">Ландшафтные и/или вегетационные индексы ответственны за генерацию более-менее протяженных ареалов в местах с относительно выровненным рельефом</span>, что хорошо видно на примере второго варианта с присутствием трех индексов. <span class="bolditalic">Введение сложных индексом в целом гомогенизирует мозаику выходных классифицированных растров</span>, так <span class="monospace">Индекс топографический позиции</span> затушевывает склоновую дифференциацию, акцентируя при этом гребне-килевое разделение.</p>

<p><span class="blackbold">K-means кластерный анализ</span> - близкий алгоритм, с несколько иной математикой "внутри" и поэтому дающий другие результаты; для сравнения используем те же переменные, что и для трех вариантов <span class="blackbold">ISODATA классификации</span></p>

<p>В общих чертах результат практически не отличим от первого варианта классификации, в частности абсолютно идентично обработан массив Эльбруса с выделенными двумя классами ледниковых (привершинных) и фирново-снежно-ледниковых ландшафтов. Аналогично сконфигурировались ледниковые полуцирки и выводные долинные ледники нивального пояса. Сходным образом интерпретированы долина Баксана и его притоков. Различия наблюдаются в катенарной дифференциации склонов: <span class="blackbold">K-means алгоритм</span> разбивает их на дробные фрагменты, тогда как <span class="blackbold">ISODATA анализ</span> сохраняет подобие высотной поясности, особенно в нижней и средней части склонов, что приближает результат изокластерной классификации к экспертно-мануальному образцу.</p>


<table id="customers">
   <table border="0" width="100%">
    <tr>
    <td><a id="Many_isocl_01.sdat_Fragm"><img src="Pict_3_15/Many_isocl_01.sdat_Fragm.png" width="100%" height="relative"></a></td>
    <td><a id="Many_clust_16_01.sdat_Fragm"><img src="Pict_3_15/Many_clust_16_01.sdat_Fragm.png" width="102%" height="relative"></a> </td>
  </tr>
</table>

<br>
<span class="imgtitle">Рис. 15.29 Сравнение фрагментов классификации, полученных по алгоритму ISODATA анализа (a) и K-Means Clustering for Grids (b)
<br>
<br>


<div class="script_01">
<figure>
<a id="Many_clust_16_02"><img src="Pict_3_15/Many_clust_16_02.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Many_clust_16_02_leg"><img src="Pict_3_15/Many_clust_16_02_leg.png"width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.30 Синтез девяти слоев (набор переменных - второй вариант) по алгоритму K-Means Clustering for Grids SAGA GIS</p>

<p>Очевидно, что решение о наборе переменных, которые мы бросаем в "топку" кластерного анализа принимается на основе экспертных знаний. Но есть еще одна полезная операция, которая поможет "убрать лишнее" из набора, т.е., вывести из анализа те показатели, которые слишком сильно коррелируют друг с другом и могут повлиять на результат классификации. Анализ главных компонент или расширение Кархунена-Лоева (Karhunen-Loeve) - классический метод уменьшения размерности или анализа исследовательских данных. <span class="monospace">Коэффициенты корреляции</span> (и/или <span class="monospace">коэффициенты ковариации</span>) между многими растровыми слоями можно рассчитать с помощью <span class="backbold">Principal Component Analysis|Анализа Главных Компонент</span>. Инструмент реализован как в <span class="blue">SAGA GIS</span>: (<span class="monospace">Spatial and Geostatistic >> Principal Component Analysis (PCA)</span>), так и в <span class="red">ArcMAP10.x</span> (<span class="monospace">Spatial Analyst Tools >> Multivariate >> Principal Components</span>).</p>

<p>В <span class="blue">SAGA GIS</span> разработанный <b>О.Конрадом</b> (O.Conrad, 2010) инструмент "запрашивает" на вход растры-переменные; критическая опция <span class="cursive">Method|Метод</span>, позволяет получить три варианта аналитической матрицы на выходе <span class="cursive">correlation matrix</span> (таблица коэффициентов корреляции), <span class="cursive">variance-covariance matrix</span> (таблица коэффициентов ковариации), <span class="cursive">sums-of-square-and-cross-products-matrix</span> (таблица сумм квадратов).</p>

<p>Выходной файл <span class="backgreen">PCA Eigen Vectors</span> в данном случае отражает <span class="cursive">variance-covariance matrix</span> может быть сохранен в формате <span class="cursive">DBF</span> и проанализирован по значениям коэффициентов ковариации. В общем случае полагают, что любые пары переменных со значениями коэффициента выше <span class="greencursiv">0,60</span> должны быть внимательно рассмотрены, со значениями большими <span class="greencursiv">0,80</span> однозначно отбракованы, т.е., из двух таких переменных для последующего включения в любые инструменты синтеза (кластерный анализ и др.) должен быть оставлен только один.</p>

<a id="pca_covariate_matrixExcel"><img src="Pict_3_15/pca_covariate_matrixExcel.png" width="75%"></a><br>
<span class="imgtitle">Рис. 15.31 Скриншот таблицы коэффициентов ковариации (variance-covariance matrix) Анализа Главных Компонент для 14 геоморфометрических переменных 

<p>Построение матрицы ковариации <span class="monospace">Анализа Главных Компонент</span> для набора из <span class="greencursiv">14</span> геоморфометрических переменных позволяет наглядно выявить близкие по смыслу параметры, которые не должны использоваться в одних и тех же процедурах классификации, кластерного анализа и т.д. Так очевидно связаны между собой параметры <span class="monospace">Normalized Height|Нормализованная высота</span> и <span class="monospace">Valley Depth|Глубина долин</span> (<span class="greencursiv">Kv=0,943</span>), <span class="monospace">Topographic Position Index|Индекс топографической позиции</span> и <span class="monospace">Plan Curvature|Плановая кривизна</span> (<span class="greencursiv">Kv=0,998</span>) <span class="monospace">LS-factor|Фактор длины-крутизны склона</span> (<span class="greencursiv">Kv=0,942</span>), <span class="monospace">Topographic Wetness Index|Топографический индекс влажности</span> и <span class="monospace">Slope|Уклон</span> (<span class="greencursiv">Kv=0,973</span>), <span class="monospace">Profile Curvature|Профильная кривизна</span> и <span class="monospace">Convergence Index|Индекс конвергенции</span>, <span class="monospace">Positive Openness|Положительная открытость</span> и <span class="monospace">Maximum Curvature|Максимальная кривизна</span>, <span class="monospace">Entropy|Энтропия рельефа</span> и <span class="monospace">Minimum Curvature|Минимальная кривизна</span>.</p>

<p>Переменные, отражающие состояние растительного покрова и землепользования - в частности, вегетационные и ландшафтные индексы также могут оказаться связанными между собой. <span class="monospace">Анализ Главных Компонент</span> для девяти таких индексов обнаруживает тесно связанные индексы: <span class="monospace">WDVI</span> и <span class="monospace">NDVI</span>, <span class="monospace">VARI</span> и  <span class="monospace">IPVI</span>, <span class="monospace">SAVI</span> и <span class="monospace">NDWI</span>, <span class="monospace">NDSI</span> и <span class="monospace">ThTVI</span>.</p>

<a id="PC1_VegIn_covariate"><img src="Pict_3_15/PC1_VegIn_covariate.png" width="60%"></a><br>
<span class="imgtitle">Рис. 15.32 Скриншот таблицы коэффициентов ковариации для 9 вегетационных и ландшафтных индексов 

<p><span class="bolditalic">Таким образом, c одной стороны, взаимосвязанные переменные не могут быть использованы в одном и том же наборе, подаваемом на вход в инструментах классификации, с другой - дают возможность замены переменных в качестве инвариантов в различных сочетаниях показателей</span>.</p>
<br>


<h3 id="h3_6">15.6.Сложные алгоритмы моделирования - классификация с возможностью обучения</h3>


<p><span class="bolditalic">Методы машинного (компьютерного) зрения представляют собой реализацию объектно-ориентированной классификации, т.е., в ходе работы алгоритма происходит не только определение спектральных показателей объекта, но и определение контуров и геометрических характеристик</span>. Поэтому в качестве обучающей выборки для компьютерного зрения должны выступать не отдельные пиксели изображения, а их ансамбли, соответствующие ареалам прототипа ландшафтной карты или лесохозяйственным выделам, что автоматически увеличивает требования к объему обучающей выборки минимум на два порядка</p>

<p> Современные ГИС-пакеты предоставляют  достаточно широкий набор популярных инструментов так называемого "машинного обучения". Так в <span class="blue">SAGA GIS</span> мы обнаружим следующие алгоритмы:</p>

<ul>
<li>Artificial Neural Network Classification|Искуственные нейронные сети,</li>
<li>Boosting Classification|Бустинг,</li>
<li>K-Nearest Neighbours Classification|KNN классификатор,</li>
<li>Decision Tree Classification|Дерево решений,</li>
<li>Logistic Regression|Логистическая регрессия,</li>
<li>Normal Bayes Classification|Байесовский классификатор,</li>
<li>Random Forest Classification|Случайный лес,</li>
<li>Support Vector Machine Classification|Метод опорных векторов.</li>
</ul>

<p>Несмотря на различия, все инструменты геоинформационного моделирования,  построены на интеграции библиотек машинного обучения (<span class="monospace">Machine Learning library</span>) для классификации основе совокупности переменных, и по этой причине имеют схожий интерфейс:  пользователь определяет набор растровых переменных и обучающий векторный (полигональный) файл с полем значений, задающих номер класса. Число выходных классов также определяется числом таксонов обучающего вектора, хотя в некоторых алгоритмах его следует указать в качестве минимального. Остальные опции являются специфичными для каждого конкретного алгоритма и, как правило, требуют "тонкой" настройки.</p>

<p>Основная проблема, общая для всех методов с использованием машинного обучения заключается поиске подходящего источника исходных (т.е., собственно "обучающих") данных. Для этой цели могут быть выбраны:

<ul>
<li>Обучение по экспертной ландшафтной карте,</li>
<li>Обучение по наземным съемкам (ландшафтным описаниям, геоботаническим площадкам),</li>
<li>Обучение по картам лесоустройства (для лесопокрытых ареалов).</li>
</ul>
</p>

<p>Преимущества и недостатки первого варианта (использование экспертной карты "ручного" рисования) мы уже обсуждали. В принципе можно взять любую такую карту, оцифровать ее, и попытаться извлечь в векторные полигоны ареалов (каковые, по идее, и должны представлять собой "ядра типичности") значения переменных, полученных по данным дистанционного зондирования - геоморфологических метрик и вегетационных и/или ландшафтных индексов, однако результат, как правило, оказывается разочаровывающим: разброс значений внутри большей части классов оказывается весьма заметным...</p>

<p>Обучение по наземным съемкам возможно лишь на ограниченных по площади участках, в пределах которых плотность точек (например - точек геоботанических описаний) соизмерима с разнообразием и сложностью предполагаемого рисунка выделов будущей модели: очевидно, что для больших территорий это правило  невозможно соблюсти. Поэтому в пределах обширных ареалов (измеряемых сотнями километров) наземные съемки могут рассматриваться лишь как вспомогательный источник верификации "регулярных" данных, - в качестве последних, обычно,  рассматриваются материалы лесоустройства.</p>

<p>Именно лесоустроительные данные сегодня, как правило, являются основой обучения моделей. Несомненным достоинством таких материалов можно считать достаточно крупный масштаб выделов (каковые, при съемках в масштабе <span class="greencursiv">1:10 000</span> могут считаться аналогами ландшафтных фаций и урочищ, а при съемках <span class="greencursiv">1:25 000</span> аналогами группы урочищ или местностей) и наличие целого ряда характеристик, выраженных как в понятиях номинальной (бонитет, класс товарности, лесорастительные условия, породный состав), так и в интервалах количественной шкалы, так называемые лесотаксационные параметры  - запас, полнота, рост, диаметр). И те и другие могут использоваться в соответствующих моделях как обучающие признаки.</p>

<p>Слабые стороны использования лесоустроительных данных также хорошо известны: <br>
<ul>
<li>устаревший характер материалов (вопреки существующим правилам обновления многие лесные регламенты имеют возраст, значительно превышающий 10 лет);</li>
<li>неизбежный "отпечаток"  регулярной квартальной и неправильной повыдельной сеток, по которым фиксируются и агрегируются лесотаксационные параметры;</li>
<li>зачастую невысокое качества и недостоверность данных (особенно в труднодоступных и многолесных ареалах);</li>
<li>необходимость закладки пробных площадок (не менее 1 на 1 км<sup>2</sup>) в лесных насаждениях для верификации и устранение возможных ошибок.</li>
</ul>

<p>Содержательная проблема, которую приходится решать при построении и отладке любых моделей классификации с обучением - набор исходных данных, используемых для характеристики морфодинамической основы и состояний ландшафта; как правило, это геоморфометрические переменные, производные от <span class="monospace">ЦМР</span> и различные вегетационные и/или ландшафтные индексы (получаемые в результате обработки и расчета по каналам сенсоров типа <span class="monospace">Landsat</span> или <span class="monospace">Sentinel</span>).</p>

<a id="table074"><span class="imgtitle">Таблица 15.2 Признаки, наиболее часто используемые для сегментации ландшафтов при классификации с обучением</span></a>

<div class="table">
<table id="customers">
        <table border="1" width=100%>
<tr>
<th>Индексы/Метрики</th>
<th>Признаки</th>
<th>Входные данные</th>
</tr>

<tr>
	<th colspan="3">Растительный покров</th>
</tr>

<tr>
<th>NDVI</th>
<td>Normalized difference vegetation index </td>
<td>Red, NIR</td>
</tr>

<tr>
<th>TNDVI</th>
<td>Transformed normalized difference vegetation index </td>
<td>Red, NIR</td>
</tr>

<tr>
<th>RVI</th>
<td>Ratio vegetation index </td>
<td>Red, NIR</td>
</tr>

<tr>
<th>SAVI</th>
<td>Soil adjusted vegetation index </td>
<td>Red, NIR</td>
</tr>

<tr>
<th>TSAVI </th>
<td>Transformed soil adjusted vegetation index </td>
<td>Red, NIR</td>
</tr>
 
<tr>
<th>MSAVI</th>
<td>Modified soil adjusted vegetation index</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>MSAVI2</th>
<td>Modified soil adjusted vegetation index 2</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>GEMI</th>
<td>Global environment monitoring index</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>IPVI</th>
<td>Infrared percentage vegetation index</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>LAIFromNDVILog</th>
<td>Leaf Area Index from log NDVI</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>LAIFromReflLinear</th>
<td>Leaf Area Index from reflectances with linear combination</td>
<td>Red, NIR</td>
</tr>

<tr>
<th>LAIFromNDVIFormo</th>
<td>Leaf Area Index from Formosat 2 TOC</td>
<td>Red, NIR</td>
</tr>

<tr>
	<th colspan="3">Водные объекты</th>
</tr>


<tr>
<th>NDWI (Gao 1996)</th>
<td>Normalized difference water index </td>
<td>NIR, MIR</td>
</tr>

<tr>
<th>NDWI2</th>
<td>Normalized difference water index (Mc Feeters 1996)</td>
<td>Green, NIR</td>
</tr>

<tr>
<th>MNDWI </th>
<td>Modified normalized difference water index (Xu 2006)</td>
<td>Green, MIR</td>
</tr>

<tr>
<th>NDTI</th>
<td>Normalized difference turbidity index (Lacaux et al.)</td>
<td>Red, Green</td>
</tr>

<tr>
	<th colspan="3">Почвы и грунты</th>
</tr>

<tr>
<th>RI</th>
<td>Redness index</td>
<td>Red, Green</td>
</tr>
 
<tr>
<th>CI</th>
<td>Color index</td>
<td>Red, Green</td>
</tr>

<tr>
<th>BI</th>
<td>Brightness index</td>
<td>Red, Green</td>
</tr>

<tr>
<th>BI2</th>
<td>Brightness index 2 </td>
<td>NIR, Red, Green</td>
</tr>

<tr>
	<th colspan="3">Антропогенные объекты</th>
</tr>

<tr>
<th>BSU</th>
<td>Built Surfaces Index</td>
<td>NIR,Red</td>
</tr>

<tr>
	<th colspan="3">Геоморфометрические переменные</th>
</tr>

<tr>
<th>STD H</th>
<td>Standard deviation of elevation</td>
<td>Elevation</td>
</tr>

<tr>
<th>Slope</th>
<td>Slope gradient</td>
<td>Elevation</td>
</tr>

<tr>
<th>Aspect</th>
<td>Slope aspect</td>
<td>Elevation</td>
</tr>

<tr>
<th>CrvPln</th>
<td>Plane curvature</td>
<td>Elevation</td>
</tr>

<tr>
<th>CrvPrf</th>
<td>Profile curvature</td>
<td>Elevation</td>
</tr>

<tr>
<th>CrvTng</th>
<td>Tangential curvature</td>
<td>Plane curvature</td>
</tr>

<tr>
<th>CrvMax</th>
<td>Maximum curvature</td>
<td>Elevation</td>
</tr>

<tr>
<th>CrvMix</th>
<td>Minimum curvature</td>
<td>Elevation</td>
</tr>

<tr>
<th>CrvTot</th>
<td>Total Curvature</td>
<td>Elevation</td>
</tr>

<tr>
<th>HAR</th>
<td>Height above river</td>
<td>Channel, Flow accumulation</td>
</tr>

<tr>
<th>HAND</th>
<td>Height above nearest depression and channel</td>
<td>Channel, Elevation</td>
</tr>

<tr>
<th>VlDpth</th>
<td>Valley Depth</td>
<td>Channel, Elevation</td>
</tr>

<tr>
<th>HlHght</th>
<td>Hill Height</td>
<td>Elevation</td>
</tr>

<tr>
<th>PosOpn</th>
<td>Positive Openness</td>
<td>Elevation</td>
</tr>h

<tr>
<th>TPI</th>
<td>Topographic Position Index</td>
<td>Elevation</td>
</tr>
</table>

<br>



<p>Инструмент <span class="blue">SAGA GIS</span> <span class="blackbold">Artificial Neural Network Classification</span>(O.Conrad, 2016) (Imagery >> OpenCV) представляет собой интеграцию библиотеки машинного обучения <span class="monospace">OpenCV</span> для классификации искусственных нейронных сетей на основе переменных гридов (растровых слоев).Специфические опции инструмента:</p> 
<div class="script">
	Options <br>
	Load Model <br>
Training areas: *указывается файл с образцами
Training Method|способ распространения: resilient propagation, back propagation <br>
Number of Layers|Число слоев нейросети: *по умолчанию - 3<br>
Number of Neurons|Число нейронов: в каждом слое нейросети: *по умолчанию 3<br>
Maximum Number of Iteration|Максимальное число итераций: *по умолчанию 300<br>
Error change Epsilon|Критерий прекращения обучающего алгоритма:  *определяет насколько велико различие между итерациями для продолжения процесса *по умолчанию 0,0000012<br>
Activation Function|Функция активации: Sigmoid 
</div>

<p>Для классификации используем уже выбранные нами девять переменных:</p>

<ol>
<li>Normalized Height|Нормализованная высота,</li>
<li>Slope|Уклон поверхности,</li>
<li>Openness|Общая открытость,</li>
<li>Valley Depth|Глубина долин,</li>
<li>Maximum Curvature|Максимальная кривизна,</li>
<li>Minimal Curvature|Минимальная кривизна,</li>
<li>IPVI, Infrared Percentage Vegetation Index|Инфракрасный вегетационный индекс,</li>
<li>NDWI, Normalised Water Index Differentiated|Нормализованный Дифференцированный водный Индекс,</li>
<li>NDMI, Normalized Difference Moisture Index |Стандартизованный индекс различий увлажненности.</li>
</ol>

<p>Критическими параметрами, требующими особого внимания, являются <span class="cursive">Число слоев нейросети</span> и <span class="cursive">Число нейронов</span>. Так в нашем случае при использовании дефолтных значений сеть как бы "недорабатывает" и итоговый рисунок выглядит далеким от обучающего образца</p>

<div class="script_01">
<figure>
<a id="ArtNeironClass_13"><img src="Pict_3_15/ArtNeironClass_13.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="ArtNeironClass_13_L"><img src="Pict_3_15/ArtNeironClass_13_L.png" width="25%" height="relative"></a>  
</figure>
</div>
<br>

<div class="script_01">
<figure>
<a id="ArtNeironClass_13_02"><img src="Pict_3_15/ArtNeironClass_13_02.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="ArtNeironClass_13_02_L"><img src="Pict_3_15/ArtNeironClass_13_02_L.png" width="25%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.33   Результат классификации по девяти переменным инструментом Artificial Neural Network Classification SAGA GIS с параметрами: a) Число слоев сети - 3, Число нейронов - 3, b) Число слоев сети -5, Число нейронов - 5</span>

<p>Показательно, что <span class="blackbold">Artificial Neural Network Classification</span> в <span class="blue">SAGA GIS</span> выдает легенду, внешне соответствующую обучающему файлу (13 классов), но при открытии классифицированного растра в <span class="red">ArcMAP10.x</span> обнаружим 7 классов с индивидуальными значениям; при этом увеличение числа слоев и нейронов нейронной сети  влияет на сложность итоговой мозаики, приближая ее к "образцу" экспертной карты, но не меняет количества классов: алгоритм <span class="blackbold">ANNC</span> (при использованных переменных и принятых значениях опций) "не видит" необходимости в 13 таксонах).</p>

<p><span class="blackbold">Decision Tree Classification</span> использует алгоритм  <span class="monospace">Decision Tree|Дерево решений</span>   имитирующий процедуру того, как решает задачи прогнозирования человек. В общем случае это k-ичное дерево с решающими правилами в нелистовых вершинах (узлах) и некотором заключении о целевой функции в листовых вершинах (прогнозом). Решающее правило — функция от объекта, позволяющее определить, в какую из дочерних вершин нужно поместить рассматриваемый объект. В листовых вершинах могут находиться разные объекты: класс, который нужно присвоить попавшему туда объекту (в задаче классификации), вероятности классов (в задаче вероятности), непосредственно значение целевой функции (задача регрессии)</a>.</p>

<p>Интерфейс инструмента <span class="blackbold">Decision Tree Classification</span> включает параметры <span class="cursive">Maximum Tree Depth</span>, <span class="cursive">Minimum Sample Count</span> и <span class="cursive">Maximum Categories</span>; дефолтный результат <span class="blackbold">Дерева решений</span> в нашем случае (изменен только параметр <span class="cursive">Maximum Categories</span> - в соответствии с числом классом) ближе к обучающему образцу.</p>

<div class="script_01">
<figure>
<a id="decisionTreeClass"><img src="Pict_3_15/decisionTreeClass.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="decisionTreeClass_L"><img src="Pict_3_15/decisionTreeClass_L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15. 34  Результат классификации по девяти переменным инструментом Decision Tree Classification SAGA GIS</p>

<p>Полученная с использованием <span class="blackbold">Decision Tree</span> для ключевого участка Приэльбрусья классификация выдерживает заданное образцом число классов (13), хорошо выделяет долину Баксана, передает целостность массива Эльбруса (разделяя его склоны и контрфорсы) и корректно отражает катенарную и гребне-килевую классификацию местности; кроме того, алгоритм конфигурирует классы склонов разной экспозиции. В целом можно констатировать что при данном наборе параметров алгоритм позволяет получить результат, максимально близкий к экспертной ландшафтной карте.</p>

<table id="customers">
   <table border="0">
    <tr>
    <td><a id="landkarta_fr"><img src="Pict_3_15/landkarta_fr.png" width="300" height="relative"></a></td>
    <td><a id="decisionTreeFragm"><img src="Pict_3_15/decisionTreeFragm.png"width="300" height="relative"></a></td>
  </tr>
</table> 

<br>
<span class="imgtitle">Рис. 15. 35 a) фрагмент экспертной ландшафтной карты, использованной для обучения  b) классификация на 13 классов инструментом Decision Tree  SAGA GIS</p>

<p><span class="blackbold">Random Forest Classification </span> алгоритм машинного обучения, заключающийся в использовании ансамбля деревьев решений,  каждое из которых само по себе даёт очень невысокое качество классификации, но совокупный результат может получиться удовлетворительным <a href="https://ru.wikipedia.org/wiki/Random_forest">"Случайный Лес"</a>. Интерфейс инструмента практически полностью аналогичен инструменту <span class="blackbold">Decision Tree Classification</span> и результат классификации также почти эквивалентен.</p>

<div class="script_01">
<figure>
<a id="Random_ Forest 13"><img src="Pict_3_15/Random_ Forest 13.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Random_ Forest 13_L"><img src="Pict_3_15/Random_ Forest 13_L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.36  Результат классификации по девяти переменным инструментом Random Forest Classification  SAGA GIS</p>


<p>Еще один широко используемый способ машинного обучения - <span class="blackbold">K-Nearest Neighbours Classification|Метод k-ближайших соседей</span> метрический алгоритм для автоматической классификации объектов. Суть метода в том, что объект приписывается к тому классу, который является наиболее распространённым среди <span class="monospace">k-соседей</span>, классы которых уже известны. Алгоритм может быть применим к выборкам с большим количеством атрибутов (многомерным). Среди критических опций:<br>

<div class="script">

Defoult Number of Neighbours|Число Соседей: *по умолчанию 3,<br>
Training Method (classification, regression model: в данном случае - классификация),<br> 
Algoritm Type|Тип Алгоритма: *brute force. 

</div>

<div class="script_01">
<figure>
<a id="k_nearest_neighbo_class_9_map"><img src="Pict_3_15/k_nearest_neighbo_class_9_map.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="k_nearest_neighbo_class_9_L"><img src="Pict_3_15/k_nearest_neighbo_class_9_L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.37  Результат по 9 переменным K-Nearest Neighbours Classification SAGA с обучением</p>

<p>Полученная с помощью <span class="blackbold">K-Nearest Neighbours</span> классификация также неплохо справляется с передачей катенарной и гребне-килевой дифференциации, обеспечивает более подробную мозаику классов, но при этом хуже передает различия между склонами разной экспозиции.</p>

<p><span class="blackbold">Logistic Regression (OpenCV)</span>  - как явствует из названия этот инструмент использует логистическую регрессию для решения задач классификации с линейно-разделяемыми классами. Предполагается, что зависимая переменная (в данном случае класс ландшафтов) принимает два значения и имеет биномиальное распределение, т.е., дискретное распределение вероятностей случайной величины <span class="greencursiv">X</span>, принимающей целочисленные значения.  Данное распределение характеризуется двумя параметрами: целым числом <span class="greencursiv">n>0</span>, называемым числом испытаний, и вещественным числом <span class="greencursiv">P<sub>1</sub></span>, находящимся в диапазоне между <span class="greencursiv">0</span> и <span class="greencursiv">1</span> называемом вероятностью успеха в одном испытании. Критические опции:<br>

<div class="script">
Learning Rate|Вероятность успеха в одном испытании,<br>
Namber of Iteration|Число итераций,<br>
Regularization|Регуляция, <br>
Training Method|Метод обучения: *определяет каким образом будет проходить обучение, варианты -  Batch Gradient Descent|Пакетным градиентный спуск или Batch Mini Gradient Descent|Мини-пакетный градиентный спуск,<br>
Количество итераций можно рассматривать как количество выполненных шагов, а скорость обучения определяет продолжительность процедуры классификации. Для компенсации переобучения может быть выполнена регуляризация. (L1 или L2 в позиции Regularization).
</div>

<div class="script_01">
<figure>
<a id="Logistic_Regression13"><img src="Pict_3_15/Logistic_Regression13.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Logistic_Regression_L"><img src="Pict_3_15/Logistic_Regression_L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.38  Результат  классификации по девяти переменным Logistic Regression  с обучением</p>

<p>Дефолтный результат на ключевом участке выдает 9 конечных классов с неплохо переданной гребне-килевой и катенарной дифференциацией, а также с учтенной экспозицией, однако, как можно видеть, массив Эльбруса лишен различий между прямыми склонами и контрфорсами, а долина Баксана "слилась" со склонами южной и юго-восточной экспозиции</p>

<p><span class="blackbold">Normal Bayes Classification Байесовская классификация</span> |- закрытый алгоритм <span class="blue">SAGA GIS</span> не содержащий каких-либо опций в диалоговом окне (кроме входящего файла обучающего векторного файла), но, тем не менее, обеспечивающий неплохие результаты.</p>

<div class="script_01">
<figure>
<a id="Normal Bayes13"><img src="Pict_3_15/Normal Bayes13.png"  width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Normal Bayes13_L"><img src="Pict_3_15/Normal Bayes13_L.png"width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.39 Результат Normal Bayes Classification классификации по девяти переменным с обучением</p>

<p>Классификация сохраняет целевое число конечных таксонов, отражает склоновую и гребне-килевую дифференциацию, различие в экспозициях макросклонов и выделяет элементы долинно-речной сети.</p>

<p><span class="blackbold">Support Vector Machine Classification (OpenCV)|Метод опорных векторов </span> — один из наиболее популярных методов обучения, который применяется для решения задач классификации и регрессии. Основная идея метода заключается в построении гиперплоскости, разделяющей объекты выборки оптимальным способом. Предполагается, что чем больше расстояние (зазор) между разделяющей гиперплоскостью и объектами разделяемых классов, тем меньше будет средняя ошибка классификатора. Метод достаточно сложен, требует больше вычислительных ресурсов и занимает больше времени чем все предыдущие методы машинного обучения.</p>

<div class="script_01">
<figure>
<a id="Vector_Machine_Classi_13._01"><img src="Pict_3_15/Vector_Machine_Classi_13._01.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Vector_Machine_Classi_13._01_L"><img src="Pict_3_15/Vector_Machine_Classi_13._01_L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15.40   Результат Support Vector Machine Classification  классификации по 9 переменным  SAGA с обучением</p>

<p>Результат алгоритма <span class="monospace">Опорных Векторов</span>, вероятно, порадовал бы глаз "классического ландшафтоведа", поскольку полученная классификация отлично выражает две комплементарные подсистемы: долинно-речной сети и водоразделов горных хребтов и контрфорсов, однако при этом теряются детали катенарной дифференциации. Из девяти входных файлов четыре принадлежат к вегетационным индексам, однако их вклад оказался затушеванным геоморфологическими факторами.</p>

<p>Можно, разумеется, менять входные факторы - в частности заменить Топографический Индекс на показатели Кривизны: классификация приобретает иной вид, однако, влияние биоты в ней по-прежнему неочевидно...</p>

<div class="script_01">
<figure>
<a id="Vector_Machine_Classi_13_02"><img src="Pict_3_15/Vector_Machine_Classi_13_02.png" width="500"  height="relative"></a>
</figure>
<figure align=right>
<a id="Vector_Machine_Classi_13_02L"><img src="Pict_3_15/Vector_Machine_Classi_13_02L.png" width="20%" height="relative"></a>  
</figure>
</div>
<br>
<span class="imgtitle">Рис. 15. 41 Результат Support Vector Machine Classification  классификации по девяти переменным с заменой Топографического Индекса на Максимальную и Минимальную Кривизны SAGA с обучением</p>

<p>Подводя итоги данного раздела, заметим, что ГИС-моделирование в любой области географии и экологии — сложный и трудоемкий процесс, требующий терпения, толерантности и объективности. Возможно, эти качества объясняют закономерный возврат (хотя уж на новом уровне) к экспертным подходам. <span class="bolditalic">Разрабатываемые сегодня, модели (в частности — алгоритмы геоморфологического, почвенного и ландшафтного моделирования) можно охарактеризовать как синтетические, и в таком качестве они вбирают в себя все лучшее из накопленного за четверть века арсенала, а именно: разделение процесса на этапы, соответствующие разным пространственным (иерархическим) уровням, возможность выбора и смены ведущего фактора дифференциации на каждом из таких уровней, предварительное конфигурирование и параметрическое описание прогнозируемых сущностей, формулировку экспертных правил нечеткой принадлежности, использование алгоритмов кластерного анализа и "машинного обучения"</span>.</p>

<p>Попытаемся сформулировать в самом общем виде базовые позиции, которые могут быть отнесены к арсеналу достижений ГИС-моделирования.</p>

<p>Традиционные экспертные геоэкологические классификации экосистем и соответствующие продукты тематического ручного картографирования представляют собой форму эвристического концептуального моделирования, недостаток которого заключается в том, что, хотя подобное моделирование и представлялось "системным", его правила и процедуры не всегда являются потенциально алгоритмизируемыми и воспроизводимыми. По этой причине традиционное экспертное картографирование не может быть надежной основой для формирования баз данных, необходимых для управления природопользованием и сопровождения практики ландшафтного планирования.</p>

<p>История развития и совершенствования методов ГИС-моделирования во-многом повторяет и воспроизводит историю развития традиционных подходов, с той, однако, разницей, что отработанные в ГИС-моделировании исследовательские сюжеты раз и навсегда получают доказательное обоснование. Так, например, с позиций ГИС- моделирования процедуры "индивидуального физико-географического районирования" и "типологического картографирования" могут быть осуществлены одним и тем же инструментом кластерного анализа и различаются определением условий соседства прогнозируемых полигонов и алгоритмом описания близости по выбранным параметрам дифференциации.</p>

<p>Мы вынуждены согласиться с тем утверждением, что не существует "идеальных" алгоритмов моделирования "на все случаи жизни": разработанные на сегодняшний день методы отличаются прежде всего по лежащей в их основе "математике" (множественная линейная регрессия,  дискриминантный анализ,   кластеризация k-средних,   обобщенные линейные модели,  обобщенные аддитивные модели,  искусственные нейронные сети и  деревья классификации). Помимо этого, алгоритмы различаются по набору и взаимным отношениям входных параметров, степени автоматизации, участию "экспертного знания", числу "шагов" (этапов) моделирования, возможности учета разных масштабов и свойств фрактальности, наконец (но не в последнюю очередь) - по предсказательной способности. Ни один из этих методов не "лучше" в том смысле, что каждому присущи свои свойства, такие как простота (или сложность) использования, доступность и прозрачность интерпретации, чувствительность к размеру выборки и т.д. Так, уже привычные нам построенные на линейных отношениях модели будут проще нейронных сетей, но последние в большей степени соответствуют реальной действительности.</p>

</div>


<footer id="main-footer">Пространственный анализ в геоэкологии &copy; Е.Ю.Колбовский, 2022 </footer>
</div class="content">
</body>
</html>